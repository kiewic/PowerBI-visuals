var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},powerbi;!function(e){var t;!function(e){var t=function(){function e(){}return e.prototype.visitEntity=function(e,t){return this.visitDefault(e,t)},e.prototype.visitColumnRef=function(e,t){return this.visitDefault(e,t)},e.prototype.visitMeasureRef=function(e,t){return this.visitDefault(e,t)},e.prototype.visitAggr=function(e,t){return this.visitDefault(e,t)},e.prototype.visitHierarchy=function(e,t){return this.visitDefault(e,t)},e.prototype.visitHierarchyLevel=function(e,t){return this.visitDefault(e,t)},e.prototype.visitPropertyVariationSource=function(e,t){return this.visitDefault(e,t)},e.prototype.visitBetween=function(e,t){return this.visitDefault(e,t)},e.prototype.visitIn=function(e,t){return this.visitDefault(e,t)},e.prototype.visitAnd=function(e,t){return this.visitDefault(e,t)},e.prototype.visitOr=function(e,t){return this.visitDefault(e,t)},e.prototype.visitCompare=function(e,t){return this.visitDefault(e,t)},e.prototype.visitContains=function(e,t){return this.visitDefault(e,t)},e.prototype.visitExists=function(e,t){return this.visitDefault(e,t)},e.prototype.visitNot=function(e,t){return this.visitDefault(e,t)},e.prototype.visitStartsWith=function(e,t){return this.visitDefault(e,t)},e.prototype.visitConstant=function(e,t){return this.visitDefault(e,t)},e.prototype.visitDateSpan=function(e,t){return this.visitDefault(e,t)},e.prototype.visitDateAdd=function(e,t){return this.visitDefault(e,t)},e.prototype.visitNow=function(e,t){return this.visitDefault(e,t)},e.prototype.visitDefaultValue=function(e,t){return this.visitDefault(e,t)},e.prototype.visitAnyValue=function(e,t){return this.visitDefault(e,t)},e.prototype.visitDefault=function(e,t){},e}();e.DefaultSQExprVisitorWithArg=t;var r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(t);e.DefaultSQExprVisitor=r;var n=function(){function e(){}return e.prototype.visitEntity=function(e){this.visitDefault(e)},e.prototype.visitColumnRef=function(e){e.source.accept(this)},e.prototype.visitMeasureRef=function(e){e.source.accept(this)},e.prototype.visitAggr=function(e){e.arg.accept(this)},e.prototype.visitHierarchy=function(e){e.arg.accept(this)},e.prototype.visitHierarchyLevel=function(e){e.arg.accept(this)},e.prototype.visitPropertyVariationSource=function(e){e.arg.accept(this)},e.prototype.visitBetween=function(e){e.arg.accept(this),e.lower.accept(this),e.upper.accept(this)},e.prototype.visitIn=function(e){for(var t=e.args,r=0,n=t.length;n>r;r++)t[r].accept(this);for(var i=e.values,r=0,n=i.length;n>r;r++)for(var a=i[r],o=0,u=a.length;u>o;o++)a[o].accept(this)},e.prototype.visitAnd=function(e){e.left.accept(this),e.right.accept(this)},e.prototype.visitOr=function(e){e.left.accept(this),e.right.accept(this)},e.prototype.visitCompare=function(e){e.left.accept(this),e.right.accept(this)},e.prototype.visitContains=function(e){e.left.accept(this),e.right.accept(this)},e.prototype.visitExists=function(e){e.arg.accept(this)},e.prototype.visitNot=function(e){e.arg.accept(this)},e.prototype.visitStartsWith=function(e){e.left.accept(this),e.right.accept(this)},e.prototype.visitConstant=function(e){this.visitDefault(e)},e.prototype.visitDateSpan=function(e){e.arg.accept(this)},e.prototype.visitDateAdd=function(e){e.arg.accept(this)},e.prototype.visitNow=function(e){this.visitDefault(e)},e.prototype.visitDefaultValue=function(e){this.visitDefault(e)},e.prototype.visitAnyValue=function(e){this.visitDefault(e)},e.prototype.visitDefault=function(e){},e}();e.DefaultSQExprVisitorWithTraversal=n}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){function t(e){return new r(e)}e.createEnumType=t;var r=function(){function e(e){this.allMembers=e}return e.prototype.members=function(e){var t=this.allMembers;if(!e)return t;for(var r=[],n=0;n<t.length;n++){var i=t[n];_.contains(e,i.value)&&r.push(i)}return r},e}()}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(e){if(e===!0)return!1;var t=e;return!!t.nullable}e.nullable=t}(t=e.FillSolidColorTypeDescriptor||(e.FillSolidColorTypeDescriptor={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){e.urlType={misc:{imageUrl:!0}}}(t=e.ImageDefinition||(e.ImageDefinition={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(e){return e.fill||e.fillRule||e.filter||e.expression||e.image||e.paragraphs?!0:!1}e.isValid=t}(t=e.StructuralTypeDescriptor||(e.StructuralTypeDescriptor={}))}(powerbi||(powerbi={}));var powerbi;!function(e){function t(e){return e&y}function r(e){return(e&d)===e}function n(e){if(r(e))return null;var t=h[e];if(t){var n=t.lastIndexOf("_");if(n>0){var i=t.slice(0,n);h[i]&&(t=i)}}return t||null}function i(e,r){var n=v[e],i=h[n];if(null==i&&(i=h.Null),e&&r){var a=h[r];if(a){var o=t(a);o===v.Null?(a=i|a,h[a]&&(i=a)):o===e&&(i=a)}}return i}function a(e,t){return(e&g)===(t&g)}var o=jsCommon.EnumExtensions,u=function(){function e(e,t,r){this.underlyingType=e,this.category=t,o.hasFlag(e,h.Temporal)&&(this.temporalType=new c(e)),o.hasFlag(e,h.Geography)&&(this.geographyType=new l(e)),o.hasFlag(e,h.Miscellaneous)&&(this.miscType=new p(e)),o.hasFlag(e,h.Formatting)&&(this.formattingType=new f(e)),o.hasFlag(e,h.Enumeration)&&(this.enumType=r),o.hasFlag(e,h.Scripting)&&(this.scriptingType=new s(e))}return e.fromDescriptor=function(t){if(t=t||{},t.text)return e.fromExtendedType(h.Text);if(t.integer)return e.fromExtendedType(h.Integer);if(t.numeric)return e.fromExtendedType(h.Double);if(t.bool)return e.fromExtendedType(h.Boolean);if(t.dateTime)return e.fromExtendedType(h.DateTime);if(t.duration)return e.fromExtendedType(h.Duration);if(t.binary)return e.fromExtendedType(h.Binary);if(t.none)return e.fromExtendedType(h.None);if(t.scripting&&t.scripting.source)return e.fromExtendedType(h.ScriptSource);if(t.enumeration)return e.fromEnum(t.enumeration);if(t.temporal){if(t.temporal.year)return e.fromExtendedType(h.Year_Integer);if(t.temporal.month)return e.fromExtendedType(h.Month_Integer)}if(t.geography){if(t.geography.address)return e.fromExtendedType(h.Address);if(t.geography.city)return e.fromExtendedType(h.City);if(t.geography.continent)return e.fromExtendedType(h.Continent);if(t.geography.country)return e.fromExtendedType(h.Country);if(t.geography.county)return e.fromExtendedType(h.County);if(t.geography.region)return e.fromExtendedType(h.Region);if(t.geography.postalCode)return e.fromExtendedType(h.PostalCode_Text);if(t.geography.stateOrProvince)return e.fromExtendedType(h.StateOrProvince);if(t.geography.place)return e.fromExtendedType(h.Place);if(t.geography.latitude)return e.fromExtendedType(h.Latitude_Double);if(t.geography.longitude)return e.fromExtendedType(h.Longitude_Double)}if(t.misc){if(t.misc.image)return e.fromExtendedType(h.Image);if(t.misc.imageUrl)return e.fromExtendedType(h.ImageUrl);if(t.misc.webUrl)return e.fromExtendedType(h.WebUrl)}if(t.formatting){if(t.formatting.color)return e.fromExtendedType(h.Color);if(t.formatting.formatString)return e.fromExtendedType(h.FormatString);if(t.formatting.alignment)return e.fromExtendedType(h.Alignment);if(t.formatting.labelDisplayUnits)return e.fromExtendedType(h.LabelDisplayUnits);if(t.formatting.fontSize)return e.fromExtendedType(h.FontSize);if(t.formatting.labelDensity)return e.fromExtendedType(h.LabelDensity)}return t.extendedType?e.fromExtendedType(t.extendedType):e.fromExtendedType(h.Null)},e.fromExtendedType=function(r){r=r||h.Null;var i=t(r),a=n(r);return e.fromPrimitiveTypeAndCategory(i,a)},e.fromPrimitiveTypeAndCategory=function(t,r){t=t||v.Null,r=r||null;var n=t.toString();return r&&(n+="|"+r),e.typeCache[n]||(e.typeCache[n]=new e(i(t,r),r))},e.fromEnum=function(t){return new e(h.Enumeration,null,t)},e.prototype.isCompatibleFrom=function(e){var t=e.primitiveType;return this===e||this.primitiveType===t||t===v.Null?!0:!1},Object.defineProperty(e.prototype,"primitiveType",{get:function(){return t(this.underlyingType)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extendedType",{get:function(){return this.underlyingType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"categoryString",{get:function(){return this.category},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.primitiveType===v.Text},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numeric",{get:function(){return o.hasFlag(this.underlyingType,h.Numeric)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"integer",{get:function(){return this.primitiveType===v.Integer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bool",{get:function(){return this.primitiveType===v.Boolean},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dateTime",{get:function(){return this.primitiveType===v.DateTime||this.primitiveType===v.Date||this.primitiveType===v.Time},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this.primitiveType===v.Duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"binary",{get:function(){return this.primitiveType===v.Binary},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"none",{get:function(){return this.primitiveType===v.None},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"temporal",{get:function(){return this.temporalType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"geography",{get:function(){return this.geographyType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"misc",{get:function(){return this.miscType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formatting",{get:function(){return this.formattingType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enum",{get:function(){return this.enumType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scripting",{get:function(){return this.scriptingType},enumerable:!0,configurable:!0}),e.typeCache={},e}();e.ValueType=u;var s=function(){function e(e){this.underlyingType=e}return Object.defineProperty(e.prototype,"source",{get:function(){return a(this.underlyingType,h.ScriptSource)},enumerable:!0,configurable:!0}),e}();e.ScriptType=s;var c=function(){function e(e){this.underlyingType=e}return Object.defineProperty(e.prototype,"year",{get:function(){return a(this.underlyingType,h.Year)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"month",{get:function(){return a(this.underlyingType,h.Month)},enumerable:!0,configurable:!0}),e}();e.TemporalType=c;var l=function(){function e(e){this.underlyingType=e}return Object.defineProperty(e.prototype,"address",{get:function(){return a(this.underlyingType,h.Address)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"city",{get:function(){return a(this.underlyingType,h.City)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"continent",{get:function(){return a(this.underlyingType,h.Continent)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"country",{get:function(){return a(this.underlyingType,h.Country)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"county",{get:function(){return a(this.underlyingType,h.County)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"region",{get:function(){return a(this.underlyingType,h.Region)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"postalCode",{get:function(){return a(this.underlyingType,h.PostalCode)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stateOrProvince",{get:function(){return a(this.underlyingType,h.StateOrProvince)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"place",{get:function(){return a(this.underlyingType,h.Place)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"latitude",{get:function(){return a(this.underlyingType,h.Latitude)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"longitude",{get:function(){return a(this.underlyingType,h.Longitude)},enumerable:!0,configurable:!0}),e}();e.GeographyType=l;var p=function(){function e(e){this.underlyingType=e}return Object.defineProperty(e.prototype,"image",{get:function(){return a(this.underlyingType,h.Image)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageUrl",{get:function(){return a(this.underlyingType,h.ImageUrl)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"webUrl",{get:function(){return a(this.underlyingType,h.WebUrl)},enumerable:!0,configurable:!0}),e}();e.MiscellaneousType=p;var f=function(){function e(e){this.underlyingType=e}return Object.defineProperty(e.prototype,"color",{get:function(){return a(this.underlyingType,h.Color)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formatString",{get:function(){return a(this.underlyingType,h.FormatString)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alignment",{get:function(){return a(this.underlyingType,h.Alignment)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelDisplayUnits",{get:function(){return a(this.underlyingType,h.LabelDisplayUnits)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return a(this.underlyingType,h.FontSize)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelDensity",{get:function(){return a(this.underlyingType,h.LabelDensity)},enumerable:!0,configurable:!0}),e}();e.FormattingType=f,function(e){e[e.Null=0]="Null",e[e.Text=1]="Text",e[e.Decimal=2]="Decimal",e[e.Double=3]="Double",e[e.Integer=4]="Integer",e[e.Boolean=5]="Boolean",e[e.Date=6]="Date",e[e.DateTime=7]="DateTime",e[e.DateTimeZone=8]="DateTimeZone",e[e.Time=9]="Time",e[e.Duration=10]="Duration",e[e.Binary=11]="Binary",e[e.None=12]="None"}(e.PrimitiveType||(e.PrimitiveType={}));var v=e.PrimitiveType;!function(e){e[e.Numeric=256]="Numeric",e[e.Temporal=512]="Temporal",e[e.Geography=1024]="Geography",e[e.Miscellaneous=2048]="Miscellaneous",e[e.Formatting=4096]="Formatting",e[e.Scripting=8192]="Scripting",e[e.Null=0]="Null",e[e.Text=1]="Text",e[e.Decimal=258]="Decimal",e[e.Double=259]="Double",e[e.Integer=260]="Integer",e[e.Boolean=5]="Boolean",e[e.Date=518]="Date",e[e.DateTime=519]="DateTime",e[e.DateTimeZone=520]="DateTimeZone",e[e.Time=521]="Time",e[e.Duration=10]="Duration",e[e.Binary=11]="Binary",e[e.None=12]="None",e[e.Year=66048]="Year",e[e.Year_Text=66049]="Year_Text",e[e.Year_Integer=66308]="Year_Integer",e[e.Year_Date=66054]="Year_Date",e[e.Year_DateTime=66055]="Year_DateTime",e[e.Month=131584]="Month",e[e.Month_Text=131585]="Month_Text",e[e.Month_Integer=131844]="Month_Integer",e[e.Month_Date=131590]="Month_Date",e[e.Month_DateTime=131591]="Month_DateTime",e[e.Address=6554625]="Address",e[e.City=6620161]="City",e[e.Continent=6685697]="Continent",e[e.Country=6751233]="Country",e[e.County=6816769]="County",e[e.Region=6882305]="Region",e[e.PostalCode=6947840]="PostalCode",e[e.PostalCode_Text=6947841]="PostalCode_Text",e[e.PostalCode_Integer=6948100]="PostalCode_Integer",e[e.StateOrProvince=7013377]="StateOrProvince",e[e.Place=7078913]="Place",e[e.Latitude=7144448]="Latitude",e[e.Latitude_Decimal=7144706]="Latitude_Decimal",e[e.Latitude_Double=7144707]="Latitude_Double",e[e.Longitude=7209984]="Longitude",e[e.Longitude_Decimal=7210242]="Longitude_Decimal",e[e.Longitude_Double=7210243]="Longitude_Double",e[e.Image=13109259]="Image",e[e.ImageUrl=13174785]="ImageUrl",e[e.WebUrl=13240321]="WebUrl",e[e.Color=19664897]="Color",e[e.FormatString=19730433]="FormatString",e[e.Alignment=20058113]="Alignment",e[e.LabelDisplayUnits=20123649]="LabelDisplayUnits",e[e.FontSize=20189443]="FontSize",e[e.LabelDensity=20254979]="LabelDensity",e[e.Enumeration=26214401]="Enumeration",e[e.ScriptSource=32776193]="ScriptSource"}(e.ExtendedType||(e.ExtendedType={}));var h=e.ExtendedType,y=255,d=65535,g=4294901760}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function e(){}return e.prototype.findProperty=function(e,t){var r=this.entities.withName(e);if(r&&!_.isEmpty(r.properties))return r.properties.withName(t)},e.prototype.findHierarchy=function(e,t){var r=this.entities.withName(e);if(r&&!_.isEmpty(r.hierarchies))return r.hierarchies.withName(t)},e.prototype.findHierarchyByVariation=function(e,t,r,n){var i=this.entities.withName(e);if(i&&!_.isEmpty(i.properties)){var a=i.properties.withName(t);if(a){var o=a.column;if(o&&!_.isEmpty(o.variations)){var u=o.variations.withName(r);if(u){var s=u.navigationProperty?u.navigationProperty.targetEntity:i;if(!s||_.isEmpty(s.hierarchies))return;return s.hierarchies.withName(n)}}}}},e.prototype.findPropertyWithKpi=function(e,t){var r=this.entities.withName(e);if(r&&!_.isEmpty(r.properties))for(var n=0,i=r.properties;n<i.length;n++){var a=i[n];if(a&&a.measure&&a.measure.kpi&&(a.measure.kpi.status===t||a.measure.kpi.goal===t))return a}},e}();e.ConceptualSchema=t,function(e){e[e.None=0]="None",e[e.Address=1]="Address",e[e.City=2]="City",e[e.Company=3]="Company",e[e.Continent=4]="Continent",e[e.Country=5]="Country",e[e.County=6]="County",e[e.Date=7]="Date",e[e.Image=8]="Image",e[e.ImageUrl=9]="ImageUrl",e[e.Latitude=10]="Latitude",e[e.Longitude=11]="Longitude",e[e.Organization=12]="Organization",e[e.Place=13]="Place",e[e.PostalCode=14]="PostalCode",e[e.Product=15]="Product",e[e.StateOrProvince=16]="StateOrProvince",e[e.WebUrl=17]="WebUrl"}(e.ConceptualDataCategory||(e.ConceptualDataCategory={}));e.ConceptualDataCategory}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){!function(e){e[e.Top=0]="Top",e[e.First=1]="First",e[e.Last=2]="Last",e[e.Sample=3]="Sample",e[e.Bottom=4]="Bottom"}(e.DataShapeBindingLimitType||(e.DataShapeBindingLimitType={}));e.DataShapeBindingLimitType;!function(e){e[e.None=0]="None",e[e.Before=1]="Before",e[e.After=2]="After"}(e.SubtotalType||(e.SubtotalType={}));e.SubtotalType}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(e){if(e){var t;return e.top&&(t={Top:{}},e.top.count&&(t.Top.Count=e.top.count)),e.bottom&&(t={Bottom:{}},e.bottom.count&&(t.Bottom.Count=e.bottom.count)),e.sample&&(t={Sample:{}},e.sample.count&&(t.Sample.Count=e.sample.count)),e.window&&(t={Window:{}},e.window.count&&(t.Window.Count=e.window.count)),t}}e.createFrom=t}(t=e.DataShapeBindingDataReduction||(e.DataShapeBindingDataReduction={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function e(e){this.schemas=e.schemas,e.links&&(this.links=e.links)}return e.prototype.schema=function(e){return this.schemas[e]},e}();e.FederatedConceptualSchema=t}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r;!function(r){function n(r,n){if(!_.isEmpty(r)){for(var i=[],a=0,o=r.length;o>a;a++){var u=r[a],s=u.data,c=void 0;if(s&&s.length)for(var l=0,p=s.length;p>l;l++)c=t.SQExprBuilder.and(c,u.data[l].expr);c&&i.push(c)}return _.isEmpty(i)?void 0:e.DataViewScopeIdentity.filterFromExprs(i,n)}}function i(r,n){var i=r.data;if(i.length!==n.length)return!1;for(var a=0,o=i.length;o>a;a++){var u=r.data[a],s=u;if(s.expr){if(!e.DataViewScopeIdentity.equals(s,n[a]))return!1}else if(!t.DataViewScopeWildcard.matches(u,n[a]))return!1}return!0}function a(e,r){var n=e.data,i=n.length;if(i!==r.length)return!1;for(var a=0;i>a;a++){var o=e.data[a],u=void 0;if(u=o.expr?t.ScopeIdentityExtractor.getKeys(o.expr):o.exprs,u&&!t.SQExprUtils.sequenceEqual(r[a],u))return!1}return!0}function o(e,t){return e=e||null,t=t||null,e===t?!0:!e!=!t?!1:e.id!==t.id?!1:e.metadata!==t.metadata?!1:u(e.data,t.data)?!0:!1}function u(e,t){if(e=e||null,t=t||null,e===t)return!0;if(!e!=!t)return!1;if(e.length!==t.length)return!1;for(var r=0,n=e.length;n>r;r++)if(!s(e[r],t[r]))return!1;return!0}function s(t,r){return!t.expr&&r.expr?!1:e.DataViewScopeIdentity.equals(t,r)}function c(e){var t={};if(e.data){for(var r=[],n=0,i=e.data.length;i>n;n++)r.push(e.data[n].key);t.data=r}return e.metadata&&(t.metadata=e.metadata),e.id&&(t.id=e.id),JSON.stringify(t)}function l(e){var t=e.data;if(!t)return!1;for(var r=0,n=t.length;n>r;r++){var i=t[r];if(i.exprs)return!0}return!1}r.filterFromSelector=n,r.matchesData=i,r.matchesKeys=a,r.equals=o,r.getKey=c,r.containsWildcard=l}(r=t.Selector||(t.Selector={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){!function(e){e[e.Table=0]="Table",e[e.Pod=1]="Pod"}(e.EntitySourceType||(e.EntitySourceType={}));e.EntitySourceType;!function(e){e[e.Day=0]="Day",e[e.Week=1]="Week",e[e.Month=2]="Month",e[e.Year=3]="Year",e[e.Decade=4]="Decade",e[e.Second=5]="Second",e[e.Minute=6]="Minute",e[e.Hour=7]="Hour"}(e.TimeUnit||(e.TimeUnit={}));e.TimeUnit;!function(e){e[e.Sum=0]="Sum",e[e.Avg=1]="Avg",e[e.Count=2]="Count",e[e.Min=3]="Min",e[e.Max=4]="Max",e[e.CountNonNull=5]="CountNonNull",e[e.Median=6]="Median",e[e.StandardDeviation=7]="StandardDeviation",e[e.Variance=8]="Variance"}(e.QueryAggregateFunction||(e.QueryAggregateFunction={}));e.QueryAggregateFunction;!function(e){e[e.Equal=0]="Equal",e[e.GreaterThan=1]="GreaterThan",e[e.GreaterThanOrEqual=2]="GreaterThanOrEqual",e[e.LessThan=3]="LessThan",e[e.LessThanOrEqual=4]="LessThanOrEqual"}(e.QueryComparisonKind||(e.QueryComparisonKind={}));e.QueryComparisonKind;!function(e){e[e.None=0]="None",e[e.Number=1]="Number",e[e.Integer=3]="Integer",e[e.DateTime=4]="DateTime",e[e.Time=8]="Time",e[e.Date=20]="Date",e[e.Month=35]="Month",e[e.Year=67]="Year",e[e.YearAndMonth=128]="YearAndMonth",e[e.MonthAndDay=256]="MonthAndDay",e[e.Decade=515]="Decade",e[e.YearAndWeek=1024]="YearAndWeek",e[e.String=2048]="String",e[e.Boolean=4096]="Boolean",e[e.Table=8192]="Table",e[e.Range=16384]="Range"}(e.SemanticType||(e.SemanticType={}));e.SemanticType;!function(e){e[e.None=0]="None",e[e.Group=1]="Group",e[e.Measure=2]="Measure"}(e.SelectKind||(e.SelectKind={}));e.SelectKind;!function(e){e[e.Default=0]="Default",e[e.Period=1]="Period"}(e.FilterKind||(e.FilterKind={}));e.FilterKind}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function e(e,t,r){this.items=e,this._activeProjectionRefs=t,this._showAll=r}return e.prototype.all=function(){return this.items},Object.defineProperty(e.prototype,"activeProjectionRefs",{get:function(){return this._activeProjectionRefs},set:function(e){for(var t=this.items.map(function(e){return e.queryRef}),r=0;r<e.length;r++){var n=e[r];if(!_.contains(t,n))return}this._activeProjectionRefs=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showAll",{get:function(){return this._showAll},set:function(e){this._showAll=e},enumerable:!0,configurable:!0}),e.prototype.addActiveQueryReference=function(e){this._activeProjectionRefs?this._activeProjectionRefs.push(e):this._activeProjectionRefs=[e]},e.prototype.getLastActiveQueryReference=function(){return _.isEmpty(this._activeProjectionRefs)?void 0:this._activeProjectionRefs[this._activeProjectionRefs.length-1]},e.prototype.clone=function(){return new e(_.clone(this.items),_.clone(this._activeProjectionRefs),this._showAll)},e}();e.QueryProjectionCollection=t;var r;!function(e){function t(e){if(!e)return e;var t={};for(var r in e)t[r]=e[r].clone();return t}function r(e,t){return e?e[t]:void 0}e.clone=t,e.getRole=r}(r=e.QueryProjectionsByRole||(e.QueryProjectionsByRole={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){!function(e){e[e.Default=0]="Default",e[e.Verbose=1]="Verbose",e[e.WholeUnits=2]="WholeUnits",e[e.DataLabels=3]="DataLabels"}(e.DisplayUnitSystemType||(e.DisplayUnitSystemType={}));e.DisplayUnitSystemType}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(e,t){if(!_.isEmpty(e)){var r=e[0];if(r.values&&r.values.length>0)for(var i=0,a=r.values.length;a>i;++i){var o=r.values[i];if(o&&o.source&&n(o.source,t))return i}}return-1}function r(e,t){if(!_.isEmpty(e))for(var r=0,i=e.length;i>r;r++)if(n(e[r].source,t))return r;return-1}function n(e,t){var r=e.roles;return r&&r[t]}function i(e,t){return null!=e&&null!=e.metadata&&e.metadata.columns&&_.any(e.metadata.columns,function(e){return e.roles&&void 0!==e.roles[t]})}e.getMeasureIndexOfRole=t,e.getCategoryIndexOfRole=r,e.hasRole=n,e.hasRoleInDataView=i}(t=e.DataRoleHelper||(e.DataRoleHelper={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function r(e){return new i(e)}var n=e.data.DataRoleHelper;t.createIDataViewCategoricalReader=r;var i=function(){function e(e){this.dataView=e;var t;e&&(t=e.categorical);var r;t&&(r=this.categories=t.categories),this.hasValidCategories=!_.isEmpty(r),this.hasValidCategories&&(this.hasCategoryObjects=!!r[0].objects);var n;t&&(n=t.values);var i=this.hasAnyValidValues=!_.isEmpty(n);i&&(this.grouped=e.categorical.values.grouped()),this.hasAnyValidValues&&(this.dataHasDynamicSeries=!!this.dataView.categorical.values.source)}return e.prototype.hasCategories=function(){return this.hasValidCategories},e.prototype.getCategoryCount=function(){return this.hasValidCategories?this.categories[0].values.length:0},e.prototype.getCategoryValues=function(e){if(this.hasValidCategories){var t=this.getCategoryFromRole(e);return t?t.values:void 0}},e.prototype.getCategoryValue=function(e,t){if(this.hasValidCategories){var r=this.getCategoryFromRole(t);return r?r.values[e]:void 0}},e.prototype.getCategoryColumn=function(e){return this.hasValidCategories?this.getCategoryFromRole(e):void 0},e.prototype.hasCompositeCategories=function(){return this.hasValidCategories?this.categories.length>1:void 0},e.prototype.hasCategoryWithRole=function(e){return-1!==n.getCategoryIndexOfRole(this.categories,e)},e.prototype.getCategoryObjects=function(e,t){return this.hasValidCategories&&this.hasCategoryObjects?this.getCategoryFromRole(t).objects[e]:void 0},e.prototype.getCategoryFromRole=function(e){var t=this.categories;return t[n.getCategoryIndexOfRole(t,e)]},e.prototype.hasValues=function(e){return-1!==this.getMeasureIndex(e)},e.prototype.getValues=function(e,t){void 0===t&&(t=0);var r=this.getMeasureIndex(e);return this.hasAnyValidValues&&-1!==r?this.grouped[t].values[r].values:void 0},e.prototype.getValue=function(e,t,r){if(this.hasAnyValidValues){var n=this.getValues(e,r);return n?n[t]:void 0}},e.prototype.getMeasureQueryName=function(e){var t=this.getMeasureIndex(e);return this.hasAnyValidValues&&-1!==t?this.grouped[0].values[t].source.queryName:void 0},e.prototype.getValueColumn=function(e,t){return void 0===t&&(t=0),this.hasAnyValidValues?this.grouped[t].values[this.getMeasureIndex(e)]:void 0},e.prototype.getMeasureIndex=function(e){return n.getMeasureIndexOfRole(this.grouped,e)},e.prototype.hasDynamicSeries=function(){return this.dataHasDynamicSeries},e.prototype.getSeriesCount=function(){return this.hasAnyValidValues?this.grouped.length:void 0},e.prototype.getSeriesObjects=function(e){return this.hasAnyValidValues?this.grouped[e].objects:void 0},e.prototype.getSeriesColumn=function(e){return this.hasAnyValidValues?this.dataView.categorical.values[e]:void 0},e.prototype.getSeriesColumns=function(){return this.hasAnyValidValues?this.dataView.categorical.values:void 0},e.prototype.getSeriesSource=function(){return this.hasAnyValidValues?this.dataView.categorical.values.source:void 0},e.prototype.getSeriesColumnIdentifier=function(){return this.hasAnyValidValues?this.dataView.categorical.values.identityFields:void 0},e.prototype.getSeriesName=function(e){return this.hasAnyValidValues?this.grouped[e].name:void 0},e.prototype.getSeriesDisplayName=function(){return this.hasAnyValidValues&&this.dataHasDynamicSeries?this.dataView.categorical.values.source.displayName:void 0},e}()}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t,r=jsCommon.JsonComparer;!function(t){function i(t,r,n){var i=t[r];i||(t[r]=i=[]);for(var a=0,o=i.length;o>a;a++){var u=i[a];if(e.Selector.equals(u.selector,n))return u}var s={selector:n,properties:{}};return i.push(s),s}function a(e,t,r,i){var a=s(e,t,r);a&&n.deleteSingleProperty(a,i)}function o(e,t,r){var n=u(e,t,r);if(n)return n[t.propertyName]}function u(e,t,r){var n=s(e,t.objectName,r);if(n)return n.properties}function s(t,r,n){if(t){var i=t[r];if(i)for(var a=0,o=i.length;o>a;a++){var u=i[a];if(e.Selector.equals(u.selector,n))return u}}}function c(t,n){return t instanceof e.SemanticFilter&&n instanceof e.SemanticFilter?e.SemanticFilter.isSameFilter(t,n):r.equals(t,n)}function l(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var r in e)if(!c(e[r],t[r]))return!1;return!0}function p(t,r){if(r.bool)return"boolean"!=typeof t&&(t=!1),e.SQExprBuilder["boolean"](t);if(r.text||r.scripting&&r.scripting.source)return e.SQExprBuilder.text(t);if(r.numeric){if($.isNumeric(t))return e.SQExprBuilder["double"](+t)}else if(r.fill){if(t)return{solid:{color:e.SQExprBuilder.text(t)}}}else{if(r.formatting)return r.formatting.labelDisplayUnits?e.SQExprBuilder["double"](+t):e.SQExprBuilder.text(t);if(r.enumeration)return $.isNumeric(t)?e.SQExprBuilder["double"](+t):e.SQExprBuilder.text(t);if(r.misc)t=t?e.SQExprBuilder.text(t):null;else if(r.image&&t){var n=t,i={name:e.SQExprBuilder.text(n.name),url:e.SQExprBuilder.text(n.url)};return n.scaling&&(i.scaling=e.SQExprBuilder.text(n.scaling)),i}}return t}function f(e){var t={};for(var r in e){var n=e[r];if(!_.isEmpty(n)){for(var i=[],a=0;a<n.length;a++){var o=n[a];i.push({properties:v(o.properties),selector:o.selector})}t[r]=i}}return t}function v(e){return _.clone(e)}t.ensure=i,t.deleteProperty=a,t.getValue=o,t.getPropertyContainer=u,t.getObjectDefinition=s,t.propertiesAreEqual=c,t.allPropertiesAreEqual=l,t.encodePropertyValue=p,t.clone=f}(t=e.DataViewObjectDefinitions||(e.DataViewObjectDefinitions={}));var n;!function(e){function t(e,t){delete e.properties[t]}e.deleteSingleProperty=t}(n=e.DataViewObjectDefinition||(e.DataViewObjectDefinition={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r;!function(t){function r(t){return a(t,function(t){var r=e.ValueType.fromDescriptor(t.type).formatting;return r&&r.formatString})}function n(e){return a(e,function(e){var t=e.type;return t&&!!t.filter})}function i(e){return a(e,function(e){var t=e.type;return t&&!!t.expression&&t.expression.defaultValue})}function a(e,t){if(e)for(var r in e){var n=e[r].properties;for(var i in n)if(t(n[i]))return{objectName:r,propertyName:i}}}t.findFormatString=r,t.findFilterOutput=n,t.findDefaultValue=i}(r=t.DataViewObjectDescriptors||(t.DataViewObjectDescriptors={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(t){function r(t,r,n){for(var i,a=0,o=n.length;o>a;a++){var u=n[a],s=u.name,c=e.DataViewObjectEvaluator.run(t,r[s],u.properties);c&&(i||(i={}),i[s]=c)}return i}function n(e){var t={data:[]};if(e)for(var r in e)for(var n=e[r],a=0,o=n.length;o>a;a++){var u=n[a];i(t,u.selector).objects.push({name:r,properties:u.properties})}return t}function i(t,r){if(!r)return t.metadataOnce||(t.metadataOnce={objects:[]}),t.metadataOnce;var n;r.data?n=t.data:r.metadata?(t.metadata||(t.metadata=[]),n=t.metadata):r.id&&(t.userDefined||(t.userDefined=[]),n=t.userDefined);for(var i=0;i<n.length;i++){var a=n[i];if(e.Selector.equals(r,a.selector))return a}var o={selector:r,objects:[]};return n.push(o),o}function a(e,t,r,n){n&&(o(e,t,r,n),u(e,t,r,n))}function o(t,r,n,i){var a=e.DataViewObjectDescriptors.findFormatString(r);if(a)for(var o=0,u=i.length;u>o;o++){var l=i[o];l&&c(t,a,l.queryName,l.format||s(n,o))}}function u(t,r,n,i){
var a=e.DataViewObjectDescriptors.findDefaultValue(r);if(a)for(var o=0;o<i.length;o++){var u=i[o];u&&l(t,a,u.queryName,u.defaultValue)}}function s(e,t){for(var r=0,n=e.length;n>r;r++){var i=e[r];if(i&&i.index===t)return i.format}}function c(t,r,n,i){i&&p(t,r,{metadata:n},e.SQExprBuilder.text(i))}function l(e,t,r,n){n&&p(e,t,{metadata:r},n)}function p(e,t,r,n){var i;if(r){var a=e.metadata;a||(a=e.metadata=[]),i=a}else{var o=e.metadataOnce;o||(o=e.metadataOnce={selector:r,objects:[]}),i=[o]}var u,s=f(i,r);if(s){var c=s.objects;if(u=v(c,t.objectName)){if(u.properties[t.propertyName])return}else u={name:t.objectName,properties:{}},c.push(u)}else u={name:t.objectName,properties:{}},i.push({selector:r,objects:[u]});u.properties[t.propertyName]=n}function f(t,r){for(var n=0,i=t.length;i>n;n++){var a=t[n];if(e.Selector.equals(a.selector,r))return a}}function v(e,t){for(var r=0,n=e.length;n>r;r++){var i=e[r];if(i.name===t)return i}}t.evaluateDataViewObjects=r,t.groupObjectsBySelector=n,t.addImplicitObjects=a}(t=e.DataViewObjectEvaluationUtils||(e.DataViewObjectEvaluationUtils={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r;!function(r){function n(e,t,r){if(t){var n,a=t.properties;for(var o in r){var u=r[o],s=a[o];if(s){var c=i(e,s,u);void 0!==c&&(n||(n={}),n[o]=c)}}return n}}function i(r,n,i){var u=n.type;if(u&&u.expression)return i;var l=v(r,i,e.ValueType.fromDescriptor(n.type));return void 0!==l||i instanceof t.RuleEvaluation?l:a(r,i,u)||o(r,i,u)||s(r,i,u)||c(r,i,u)||i}function a(t,r,n){var i=n.fill;if(i)return i&&i.solid&&i.solid.color&&r.solid?{solid:{color:v(t,r.solid.color,e.ValueType.fromExtendedType(e.ExtendedType.Color))}}:void 0}function o(e,t,r){if(r.fillRule){if(t.linearGradient2){var n=t.linearGradient2;return{linearGradient2:{min:u(e,n.min),max:u(e,n.max)}}}if(t.linearGradient3){var i=t.linearGradient3;return{linearGradient3:{min:u(e,i.min),mid:u(e,i.mid),max:u(e,i.max)}}}}}function u(e,t){var r={color:v(e,t.color,h)},n=v(e,t.value,y);return null!=n&&(r.value=n),r}function s(t,r,n){if(n.image&&r){var i={name:v(t,r.name,d),url:v(t,r.url,e.ValueType.fromDescriptor(e.ImageDefinition.urlType))};return r.scaling&&(i.scaling=v(t,r.scaling,d)),i}}function c(e,t,r){return r.paragraphs&&t?f(e,t,l):void 0}function l(e,t){var r,n=t.textRuns,i=f(e,n,p);return n!==i&&(r=_.clone(t),r.textRuns=i),r||t}function p(e,t){var r,n=t.value,i=v(e,n,d);return void 0!==i&&(r=_.clone(t),r.value=i),r||t}function f(e,t,r){for(var n,i=0,a=t.length;a>i;i++){var o=t[i],u=r(e,o);n||o===u||(n=_.take(t,i)),n&&n.push(u)}return n||t}function v(e,r,n){return r instanceof t.SQExpr?g.evaluate(r,e):r instanceof t.RuleEvaluation?r.evaluate(e):void 0}var h=e.ValueType.fromDescriptor({formatting:{color:!0}}),y=e.ValueType.fromDescriptor({numeric:!0}),d=e.ValueType.fromDescriptor({text:!0});r.run=n,r.evaluateProperty=i;var g=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.evaluate=function(e,r){return null!=e?e.accept(t.instance,r):void 0},t.prototype.visitConstant=function(e,t){return e.value},t.prototype.visitMeasureRef=function(e,t){return t.getExprValue(e)},t.prototype.visitAggr=function(e,t){return t.getExprValue(e)},t.instance=new t,t}(t.DefaultSQExprVisitorWithArg)}(r=t.DataViewObjectEvaluator||(t.DataViewObjectEvaluator={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(e,t,n){if(!e)return n;var i=e[t.objectName],a=i;return r.getValue(a,t.propertyName,n)}function n(e,t,r){if(e&&e[t]){var n=e[t];return n}return r}function i(e,t){if(e&&e[t]){var r=e[t];return r}}function a(e,r,n){var i=t(e,r);return i&&i.solid?i.solid.color:n}function o(e){return _.isArray(e)}e.getValue=t,e.getObject=n,e.getUserDefinedObjects=i,e.getFillColor=a,e.isUserDefined=o}(t=e.DataViewObjects||(e.DataViewObjects={}));var r;!function(e){function t(e,t,r){if(!e)return r;var n=e[t];return void 0===n?r:n}function r(t,r,n){var i=e.getValue(t,r);return i&&i.solid?i.solid.color:n}e.getValue=t,e.getFillColorByPropertyName=r}(r=e.DataViewObject||(e.DataViewObject={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r,n=e.Prototype.inherit;!function(e){function r(e){var r=e.categorical;if(!r)return null;var i=r.categories;if(!i||1!==i.length)return null;var a=r.values;if(_.isEmpty(a)||a.source)return null;for(var o=i[0],u=o.identity,s=o.values,c=[],l=[],p=0,f=s.length;f>p;p++)for(var v=s[p],h=u[p],y=0,d=a.length;d>y;y++){var g=a[y],m=n(g.source);if(g.identity)return null;m.groupName=v;var x={source:m,values:[g.values[p]],identity:h,min:g.min,max:g.max,subtotal:g.subtotal},b=g.highlights;b&&(x.highlights=[b[p]]),c.push(m),l.push(x)}var w=n(e.metadata);return w.columns=c,a=t.DataViewTransform.createValueColumns(l,o.identityFields,o.source),{metadata:w,categorical:{values:a},matrix:e.matrix}}e.apply=r}(r=t.DataViewPivotCategorical||(t.DataViewPivotCategorical={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r;!function(t){function r(t,r){r.columnHierarchyRewritten||(t.columns=e.Prototype.inherit(t.columns));var o=t.columns;r.rowHierarchyRewritten||(t.rows=e.Prototype.inherit(t.rows));var u=t.rows;if(!(o.levels.length>1)){var s={level:0},c=o.root.children,l=c.length;if(l>0){var p=0,f=function(e){if(e.values){s.values||(s.values={});for(var t=0;l>t;t++)s.values[p++]=e.values[t];delete e.values}if(l>1){var r=e.level+1;e.children||(e.children=[]);for(var n=0;l>n;n++){var i={level:r},a=c[n];i.levelSourceIndex=a.levelSourceIndex,e.isSubtotal&&(i.isSubtotal=!0),e.children.push(i)}}};r.hierarchyTreesRewritten?n(u.root,f):t.columns.root=a(u.root,f)}else r.hierarchyTreesRewritten||(t.columns.root=i(u.root));if(l>1){var v={sources:o.levels[0].sources};u.levels.push(v),o.levels.length=0}if(r.hierarchyTreesRewritten)t.columns.root=u.root,t.rows.root={children:[s]};else{var h=e.Prototype.inherit(t.rows.root);h.children=[s],t.rows.root=h}t.columns.levels=u.levels,t.rows.levels=[]}}function n(e,t){var r=e.children;if(r&&r.length>0)for(var i=0,a=r.length;a>i;i++)n(r[i],t);else t(e)}function i(e){return a(e)}function a(t,r){var n=e.Prototype.inherit(t),i=t.children;if(i&&i.length>0){for(var o=[],u=0,s=i.length;s>u;u++){var c=a(i[u],r);o.push(c)}n.children=o}else r&&r(n);return n}t.apply=r,t.cloneTree=i,t.cloneTreeExecuteOnLeaf=a}(r=t.DataViewPivotMatrix||(t.DataViewPivotMatrix={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function r(e){for(var t=new Array(e),r=0;e>r;r++)t[r]=null;return t}function n(t,r,n){var i=e.Prototype.inherit(t);return i[n]=r[n],i}var i;!function(i){function a(e){if(e.categorical){var t=e.categorical;if(t.categories&&1===t.categories.length&&(!t.values||!t.values.source))return o(e.metadata,t)}}function o(r,n){var i=n.categories[0],a=i.values,o=a.length;if(0!==o){var s=n.values?n.values.grouped()[0].values:[],c=t.createCategoricalDataViewBuilder().withCategories(n.categories).withGroupedValues(u(i,a,o,s)).build();return r=e.Prototype.inherit(r),r.columns=c.metadata.columns,{metadata:r,categorical:c.categorical}}}function u(e,t,i,a){for(var o=r(i),u=a.length,s=[],c=0;i>c;c++){for(var l=[],p=0;u>p;p++){var f=a[p],v=f.highlights,h={values:n(o,f.values,c)};v&&(h.highlights=n(o,v,c)),l.push(h)}s.push(l)}return{groupColumn:{source:e.source,identityFrom:{fields:e.identityFields,identities:e.identity},values:e.values},valueColumns:_.map(a,function(e){return{source:e.source}}),data:s}}i.apply=a}(i=t.DataViewSelfCrossJoin||(t.DataViewSelfCrossJoin={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r,n=jsCommon.ArrayExtensions,i=e.data.DataShapeBindingDataReduction;!function(r){function a(e,t,r,n){t&&1===t.length&&r.categorical&&r.categorical.dataReductionAlgorithm&&e&&u(e,r)&&(e.Primary.Groupings=[e.Secondary.Groupings[0],e.Primary.Groupings[0]],e.Secondary=void 0,e.DataReduction={Primary:i.createFrom(r.categorical.dataReductionAlgorithm),DataVolume:r.categorical.dataVolume||n})}function o(e){return e&&e.Groupings&&1===e.Groupings.length&&!_.isEmpty(e.Groupings[0].Projections)&&!e.Groupings[0].Subtotal&&_.isEmpty(e.Groupings[0].SuppressedProjections)}function u(e,t){return o(e.Primary)&&o(e.Secondary)&&1===e.Secondary.Groupings[0].Projections.length?e.DataReduction&&(e.DataReduction.Primary||e.DataReduction.Secondary)?!1:!0:!1}function s(e,t,r){if(!v(t,r,e))return e;var i={metadata:{columns:n.copy(e.metadata.columns)}};if(e.single&&(i.single=e.single),e.table&&(i.table=e.table),e.matrix){var a=h(e.matrix);_.isEmpty(a.valueSources)||(i.categorical=y(a,i.metadata.columns))}return i}function c(e){for(var r={},n=0;n<e.length;n++){var i=e[n],a=i.roles;if(a)for(var o in a)if(a[o]){var u=r[o];u||(u=r[o]=new t.QueryProjectionCollection([])),u.all().push({queryRef:i.queryName})}}return r}function l(t,r){for(var n={},i=0,a=r.columns;i<a.length;i++){var o=a[i];if(!(!o.index&&0!==o.index||o.index<0||o.index>=t.length)){var u=t[o.index];if(u){var s=u.queryName;s&&void 0===n[s]&&(n[s]=o.isMeasure?e.VisualDataRoleKind.Measure:e.VisualDataRoleKind.Grouping)}}}return n}function p(e,t){t&&(t.bind&&e(t.bind.to),t["for"]&&e(t["for"]["in"]),t.group&&(e(t.group.by),f(e,t.group.select)),f(e,t.select))}function f(e,t){if(!_.isEmpty(t))for(var r=0;r<t.length;r++){var n=t[r];p(e,n)}}function v(t,r,n){if(!t||!r||!n)return!1;var i=l(t,n.metadata),a=c(t);if(r=e.DataViewAnalysis.chooseDataViewMappings(a,r,i),!r||1!==r.length)return!1;var o=r[0].categorical;if(!o)return!1;var u=n.matrix;if(!u)return!1;if(!u.rows||!u.rows.levels||2!==u.rows.levels.length)return!1;var s=[],f=[],v=function(t,r){var n=a[t];if(n)for(var o=0,u=n.all();o<u.length;o++){var s=u[o];i[s.queryRef]===e.VisualDataRoleKind.Grouping&&r.push(s.queryRef)}};if(p(function(e){v(e,s)},o.categories),p(function(e){v(e,f)},o.values),_.isEmpty(s)||_.isEmpty(f))return!1;for(var h=0,y=u.columns.levels;h<y.length;h++)for(var d=y[h],g=0,m=d.sources;g<m.length;g++){var x=m[g];if(!x.isMeasure)return!1}return!0}function h(t){for(var r=t.rows,n=r.root,i=n.children,a=[],o=r.levels[0],u=n.childIdentityFields,s=[],c=r.levels[1],l=i[0].childIdentityFields,p=t.valueSources.length,f=function(t){return _.findIndex(s,function(r){return e.DataViewScopeIdentity.equals(r.identity,t)})},v=0;v<i.length;v++){var h=i[v];a.push({value:h.value,identity:h.identity});for(var y=0,d=h.children;y<d.length;y++){var g=d[y],m=f(g.identity);-1===m&&s.push({value:g.value,identity:g.identity})}}for(var x=new Array(s.length),b=0;b<a.length;++b)for(var h=i[b],w=0,E=h.children;w<E.length;w++){var g=E[w],S=f(g.identity);x[S]||(x[S]=new Array(a.length)),x[S][b]=g.values}var C={root:{children:_.map(a,function(e){return{level:0,value:e.value,identity:e.identity}}),childIdentityFields:u},levels:[o]};if(p>0){for(var D=_.map(t.columns.root.children,function(e){var t={level:1};return e.levelSourceIndex&&(t.levelSourceIndex=e.levelSourceIndex),t}),S=0;S<C.root.children.length;++S)C.root.children[S].children=D;C.levels.push(t.columns.levels[0])}var V={root:{children:_.map(s,function(e){return{level:0,value:e.value,identity:e.identity}}),childIdentityFields:l},levels:[c]};if(p>0)for(var S=0;S<s.length;++S){for(var T=V.root.children[S],P={},b=0;b<a.length;++b)for(var Q=x[S][b],F=0;p>F;++F){var A=b*p+F;P[A]=Q?Q[F]:0===F?{value:null}:{value:null,valueSourceIndex:F}}T.values=P}var N={rows:V,columns:C,valueSources:t.valueSources};return N}function y(e,t){for(var r=e.columns.root.children.length,n=e.valueSources,i=n.length,a=[{source:e.rows.levels[0].sources[0],values:_.map(e.rows.root.children,function(e){return e.value}),identity:_.map(e.rows.root.children,function(e){return e.identity}),identityFields:e.rows.root.childIdentityFields}],o=[],u=0;r>u;++u){var s=e.columns.root.children[u],c={values:[],identity:s.identity,name:s.value||null};o.push(c);for(var l=0;i>l;++l){var p=n[l],f={};for(var v in p)f[v]=p[v];f.groupName=c.name,t.push(f);var h={source:f,values:[],identity:c.identity};c.values.push(h);for(var y=l+u*i,d=0,g=e.rows.root.children;d<g.length;d++){var m=g[d],x=m.values[y].value;h.values.push(x)}}}for(var b=[],w=0;w<o.length;w++)for(var c=o[w],l=0;i>l;++l)b.push(c.values[l]);b.grouped=function(){return o},b.identityFields=e.columns.root.childIdentityFields,b.source=e.columns.levels[0].sources[0];var E={categories:a,values:b};return E}r.pivotBinding=a,r.unpivotResult=s}(r=t.DataViewPivotCategoricalToPrimaryGroups||(t.DataViewPivotCategoricalToPrimaryGroups={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r,n=e.Prototype.inherit,i=e.Prototype.inheritSingle,a=jsCommon.ArrayExtensions,o=jsCommon.EnumExtensions;!function(r){function u(e){var r=e.prototype,n=e.objectDescriptors,i=e.dataViewMappings,a=e.transforms,o=e.colorAllocatorFactory,u=e.dataRoles;if(!r)return s(n,a,o);if(!a)return[r];r=t.DataViewPivotCategoricalToPrimaryGroups.unpivotResult(r,a.selects,i);var l=a.splits;if(_.isEmpty(l))return[c(r,n,i,a,o,u)];for(var p=[],f=0;f<l.length;f++){var v=l[f],h=c(r,n,i,a,o,u,v.selects);p.push(h)}return p}function s(e,t,r){if(t&&t.objects){var n={metadata:{columns:[]}};return V(n,0,e,t.objects,t.selects,r),[n]}return[]}function c(e,r,i,a,o,u,s){var c=l(i),f=n(e);return f.metadata=n(e.metadata),f=p(f,i,a.selects,a.projectionOrdering,s),V(f,c,r,a.objects,a.selects,o),f=t.DataViewConcatenateCategoricalColumns.detectAndApply(f,i),t.DataViewNormalizeValues.apply({dataview:f,dataViewMappings:i,dataRoles:u}),f}function l(e){if(!e)return 0;for(var t=0,r=0;r<e.length;r++){var n=e[r];n.categorical&&(t|=1),n.matrix&&(t|=2),n.single&&(t|=4),n.table&&(t|=8),n.tree&&(t|=16)}return t}function p(e,r,n,i,a){var o=[];if(n&&(e.metadata.columns=f(e.metadata.columns,n,o)),e.categorical&&(e.categorical=d(e.categorical,o,a),e=te(e,r)),e.matrix){var u={rowHierarchyRewritten:!1,columnHierarchyRewritten:!1,hierarchyTreesRewritten:!1};e.matrix=x(e.matrix,o,r,i,u),ne(e.matrix,r)&&t.DataViewPivotMatrix.apply(e.matrix,u)}return e.table&&(e.table=g(e.table,o,r,i)),e}function f(e,t,r){if(!t)return e;for(var i=n(e),a=0,o=e.length;o>a;a++){var u=e[a],s=t[u.index];if(s){var c=i[a]=n(u);s.roles&&(c.roles=s.roles),s.type&&(c.type=s.type),c.format=v(s,c),s.displayName&&(c.displayName=s.displayName),s.queryName&&(c.queryName=s.queryName),s.kpi&&(c.kpi=s.kpi),s.sort&&(c.sort=s.sort),r.push({from:u,to:c})}}return i}function v(e,t){return e.format||t.format}function h(e,r){if(e){r||(r={});for(var n in e){var i=e[n],a=n,o=i,u="general";switch(n){case"hasScalarCategoryAxis":u="categoryAxis",a="axisType",o=t.SQExprBuilder.text(i?"Scalar":"Categorical");break;case"Totals":a="totals",o=t.SQExprBuilder["boolean"](!!i);break;case"textboxSettings":a="paragraphs",i&&i.paragraphs&&(o=i.paragraphs);break;case"VisualType1":a="visualType1",o=t.SQExprBuilder.text(i);break;case"VisualType2":a="visualType2",o=t.SQExprBuilder.text(i);break;case"imageVisualSettings":a="imageUrl",i&&i.imageUrl&&(o=t.SQExprBuilder.text(i.imageUrl));break;default:continue}y(r,u,a,o)}return r}}function y(e,t,r,n){var i=e[t];void 0===i&&(i=e[t]=[]);var a=i[0];void 0===a&&(a=i[0]={properties:{}}),a.properties[r]=n}function d(t,r,i){function a(e){var t=C(e.source,r);if(t){var i=n(e);return i.source=t,i}}var o=n(t),u=e.Prototype.overrideArray(t.categories,a);u&&(o.categories=u);var s=e.Prototype.overrideArray(t.values,a);if(s){if(i)for(var c=s.length-1;c>=0;c--)i[s[c].source.index]||s.splice(c,1);if(s.source)if(i&&!i[s.source.index])s.source=void 0;else{var l=C(s.source,r);l&&(s.source=l)}o.values=s,X(s)}return o}function g(t,r,i,a){if(!i||1!==i.length||!i[0].table)return t;var o=n(t),u=function(e){return C(e,r)},s=e.Prototype.overrideArray(t.columns,u);if(s&&(o.columns=s),!a)return o;var c=m(a,r);if(!c)return o;for(var l=s.slice(0),p=Object.keys(c),f=0,v=p.length;v>f;f++){var h=l[c[p[f]]];f===s.length?s.push(h):s[f]=h}var y=e.Prototype.overrideArray(o.rows,function(e){for(var t=[],r=0,n=p.length;n>r;++r)t[r]=e[c[p[r]]];return t});return y&&(o.rows=y),o}function m(e,t){var r=Object.keys(e);if(1===r.length){var n=r[0],i=_.map(t,function(e){return e.from.index}),o=e[n];if(!a.sequenceEqual(i,o,function(e,t){return e===t}))return E(i,o)}}function x(r,i,a,o,u){function s(e){return C(e,i)}function c(t){var r=null,n=e.Prototype.overrideArray(t.levels,function(t){var r=null,n=e.Prototype.overrideArray(t.sources,s);return n&&(r=D(r,t,function(e){return e.sources=n})),r});return n&&(r=D(r,t,function(e){return e.levels=n})),r}if(!a||a.length<1||!(a[0].matrix||a[1]&&a[1].matrix))return r;var l=a[0].matrix||a[1].matrix,p=n(r),f=c(p.rows);f&&(p.rows=f,u.rowHierarchyRewritten=!0);var v=c(p.columns);v&&(p.columns=v,u.columnHierarchyRewritten=!0);var h=e.Prototype.overrideArray(p.valueSources,s);if(h){p.valueSources=h;var y=l.values;if(o&&h.length>1&&y&&y["for"]){var d=v.levels.length;if(d>0){var g=w(y,o,h,i);if(g){var m=Object.keys(g),x=m.length;v.root=t.DataViewPivotMatrix.cloneTree(v.root),1===d?b(v.root,g):S(v.root,d-2,function(e){return b(e,g)}),p.rows.root=t.DataViewPivotMatrix.cloneTreeExecuteOnLeaf(p.rows.root,function(e){if(e.values){for(var t={},r=Object.keys(e.values).length/x,n=0,i=r;i>n;n++)for(var a=n*x,o=0;x>o;o++)t[a+o]=e.values[a+g[m[o]]];e.values=t}}),u.hierarchyTreesRewritten=!0}}}}return p}function b(e,t){for(var r=Object.keys(t),n=r.length,i=e.children,a=i.slice(0),o=0,u=n;u>o;o++){var s=a[t[r[o]]];o===i.length?i.push(s):i[o]=s}}function w(e,t,r,n){function i(e){for(var t=0,n=r.length;n>t;t++){var i=r[t];if(i===e.to)return e}}for(var o=e["for"]["in"],u=[],s=0,c=n.length;c>s;s++){var l=n[s];i(l)&&u.push(l)}var p=t[o],f=_.map(u,function(e){return e.from.index});return a.sequenceEqual(f,p,function(e,t){return e===t})?void 0:E(f,p)}function E(e,t){for(var r={},n=0,i=t.length;i>n;++n){var a=t[n];r[n]=e.indexOf(a)}return r}function S(e,t,r){if(e.level===t)return void r(e);var n=e.children;if(n&&n.length>0)for(var i=0,a=n.length;a>i;i++)S(n[i],t,r)}function C(e,t){for(var r=0,n=t.length;n>r;r++){var i=t[r];if(i.from===e)return i.to}}function D(e,t,r){return e||(e=n(t)),r&&r(e),e}function V(e,r,n,i,a,o){if(n){var u=t.DataViewObjectEvaluationUtils.groupObjectsBySelector(i);t.DataViewObjectEvaluationUtils.addImplicitObjects(u,n,e.metadata.columns,a);var s=u.metadataOnce,c=u.data;s&&P(e,a,n,s.objects,c,o);var l=u.metadata;if(l)for(var p=0,f=l.length;f>p;p++){var v=l[p];q(e,a,n,v.selector,v.objects)}for(var p=0,f=c.length;f>p;p++){var h=c[p];R(e,r,n,h.selector,h.rules,h.objects)}var y=u.userDefined;y&&T(e,a,n,y)}}function T(e,r,n,i){var a=e.metadata.objects;a||(a=e.metadata.objects={});for(var o=t.createStaticEvalContext(e,r),u=0;u<i.length;u++){var s=i[u],c=s.selector.id,l=t.DataViewObjectEvaluationUtils.evaluateDataViewObjects(o,n,s.objects);for(var p in l){var f=l[p],v=a[p];v||(v=a[p]=[]),v.push({id:c,object:f})}}}function P(e,r,n,i,a,o){var u=t.createStaticEvalContext(e,r),s=t.DataViewObjectEvaluationUtils.evaluateDataViewObjects(u,n,i);if(s){e.metadata.objects=s;for(var c in s){var l=s[c],p=n[c];for(var f in l){var v=p.properties[f],h=v.rule;if(h){var y=Q(e,o,h,c,l[f],v.type);y&&a.push(y)}}}}}function Q(e,t,r,n,i,a){var o=r.output;if(o){var u=U(e,o.selector);if(u)return a.fillRule?F(e,t,r,u,n,i):a.filter?O(e,r,u,n,i):void 0}}function F(e,r,n,i,a,o){var u;if(o.linearGradient2?u=A(e,r,n,o,o.linearGradient2):o.linearGradient3&&(u=N(e,r,n,o,o.linearGradient3)),u){var s=new t.ColorRuleEvaluation(n.inputRole,u),c={};return c[n.output.property]={solid:{color:s}},{selector:i,rules:[s],objects:[{name:a,properties:c}]}}}function A(e,t,r,n,i){if(i=n.linearGradient2,void 0===i.min.value||void 0===i.max.value){var a=W(e,r.inputRole);if(!a)return;void 0===i.min.value&&(i.min.value=a.min),void 0===i.max.value&&(i.max.value=a.max)}return t.linearGradient2(n.linearGradient2)}function N(e,t,r,n,i){var a=void 0;if(i=n.linearGradient3,void 0===i.min.value||void 0===i.mid.value||void 0===i.max.value){var o=W(e,r.inputRole);if(!o)return;if(a=void 0===i.min.value&&void 0===i.max.value&&void 0!==i.mid.value,void 0===i.min.value&&(i.min.value=o.min),void 0===i.max.value&&(i.max.value=o.max),void 0===i.mid.value){var u=(i.max.value+i.min.value)/2;i.mid.value=u}}return t.linearGradient3(n.linearGradient3,a)}function O(e,r,n,i,a){if(e.categorical&&e.categorical.categories&&1===e.categorical.categories.length){var o=e.categorical.categories[0].identityFields;if(o){var u=t.SQExprConverter.asScopeIdsContainer(a,o);if(u){var s=new t.FilterRuleEvaluation(u),c={};return c[r.output.property]=s,{selector:n,rules:[s],objects:[{name:i,properties:c}]}}}}}function R(e,r,n,i,a,u){var s=t.Selector.containsWildcard(i),c=e.categorical;c&&o.hasFlag(r,1)&&(j(c,n,i,a,s,u),I(c,n,i,a,s,u));var l=e.matrix;if(l&&o.hasFlag(r,2)){var p=M(l,n,i,a,s,u);p&&(e.matrix=p)}}function j(e,r,n,i,a,o){if(e.categories&&0!==e.categories.length){var u=B(e,n);if(u){var s,c=u.identities,l=t.createCategoricalEvalContext(e,c);if(c){for(var p=0,f=c.length;f>p;p++){var v=c[p];if(a||t.Selector.matchesData(n,[v])){l.setCurrentRowIndex(p);var h=t.DataViewObjectEvaluationUtils.evaluateDataViewObjects(l,r,o);if(h&&(u.column.objects||(u.column.objects=[],u.column.objects.length=f),u.column.objects[p]=h),!a)return!0;s=!0}}return s}}}}function I(r,n,i,a,o,u){var s=r.values;if(s&&s.identityFields&&t.Selector.matchesKeys(i,[s.identityFields])){var c=s.grouped();if(c){for(var l,p=t.createCategoricalEvalContext(r),f=0,v=c.length;v>f;f++){var h=c[f],y=i.metadata,d=h.values;if(o||t.Selector.matchesData(i,[h.identity])){var g=t.DataViewObjectEvaluationUtils.evaluateDataViewObjects(p,n,u);if(g)if(y)for(var m=0,x=d.length;x>m;m++){var b=d[m],w=b.source;if(w.queryName===y){var E=e.Prototype.inherit(w);E.objects=g,b.source=E,l=!0;break}}else h.objects=g,X(s,c),l=!0;if(!o)return!0}}return l}}}function M(e,r,n,a,o,u){var s=t.createMatrixEvalContext(e),c=L(s,e.rows,r,n,a,o,u),l=L(s,e.columns,r,n,a,o,u);if(c||l){var p=i(e);return c&&(p.rows=c),l&&(p.columns=l),p}}function L(e,t,r,n,a,o,u){if(t){var s=t.root;if(s){var c=k(e,s,r,n,a,o,u);if(c){var l=i(t);return l.root=c,l}}}}function k(e,r,n,a,o,u,s){var c=r.children;if(c){var l,p,f=r.childIdentityFields;f&&(p=t.Selector.matchesKeys(a,[f]));for(var v=0,h=c.length;h>v;v++){var y=c[v],d=y.identity,g=null;if(p){if(u||t.Selector.matchesData(a,[d])){var m=t.DataViewObjectEvaluationUtils.evaluateDataViewObjects(e,n,s);m&&(g=i(y),g.objects=m)}}else g=k(e,y,n,a,o,u,s);if(g&&(l||(l=H(r)),l.children[v]=g,!u))break}return l}}function H(e){if(Object.getPrototypeOf(e)!==Object.prototype)return e;var t=i(e);return t.children=n(e.children),t}function q(e,r,n,i,a){for(var o=e.metadata.columns,u=i.metadata,s=t.createStaticEvalContext(e,r),c=0,l=o.length;l>c;c++){var p=o[c];if(p.queryName===u){var f=t.DataViewObjectEvaluationUtils.evaluateDataViewObjects(s,n,a);f&&(p.objects=f)}}}function B(e,r){var n=e.categories[0];if(n.identityFields&&t.Selector.matchesKeys(r,[n.identityFields])){var i=n.identity,a=n,o=r.metadata;if(o){var u=e.values;if(u)for(var s=0,c=u.length;c>s;s++){var l=u[s];if(l.source.queryName===o){a=l;break}}}return{column:a,identities:i}}}function U(e,r){if(1===r.length){var n=e.categorical;if(n){var i=n.categories;if(i&&1===i.length){var a=i[0],o=a.source.roles,u=a.identityFields;if(o&&u&&o[r[0]])return{data:[t.DataViewScopeWildcard.fromExprs(u)]}}}}}function W(e,t){var r=e.categorical;if(r){var n=r.values;if(n)for(var i=0,a=n.length;a>i;i++){var o=n[i],u=o.source.roles;if(u&&u[t]){var s=o.min;if(void 0===s&&(s=o.minLocal),void 0!==s){var c=o.max;if(void 0===c&&(c=o.maxLocal),void 0!==c)return{min:s,max:c}}}}}}function G(e,r,n,i){if(e&&!_.isEmpty(e.Select)||!_.isEmpty(r)||i){var a={};if(e){var o=e.Select;if(o)for(var u=a.selects=[],s=0,c=o.length;c>s;s++){var l=o[s],p=z(l,s);if(u.push(p),p.format&&n){var f=t.DataViewObjectDescriptors.findFormatString(n);f&&(i||(i={}),t.DataViewObjectDefinitions.ensure(i,f.objectName,{metadata:p.queryName}).properties[f.propertyName]=t.SQExprBuilder.text(p.format))}}}if(r){var v=r.length;v>1&&(a.splits=[]);for(var s=0;v>s;s++){var y=r[s];y.Settings&&0===s&&(i=h(y.Settings,i)),y.DataRoles&&(a.selects||(a.selects=[]),a.projectionOrdering||(a.projectionOrdering={}),Y(y.DataRoles,a.selects,a.projectionOrdering)),a.splits&&a.splits.push(J(y.DataRoles))}}return i&&(a.objects=i),a}}function z(e,r){var n={};return e.Restatement&&(n.displayName=e.Restatement),e.Name?n.queryName=e.Name:n.queryName||(n.queryName="$select"+r),e.Format&&(n.format=e.Format),e.Type&&(n.type=K(e.Type,t.ConceptualDataCategory[e.DataCategory])),e.kpi&&(n.kpi=e.kpi),e.kpiStatusGraphic&&(n.kpi={graphic:e.kpiStatusGraphic}),n}function K(r,n){r=r||t.SemanticType.None;var i=e.PrimitiveType.Null;switch(r){case t.SemanticType.String:i=e.PrimitiveType.Text;break;case t.SemanticType.Number:i=e.PrimitiveType.Double;break;case t.SemanticType.Integer:i=e.PrimitiveType.Integer;break;case t.SemanticType.Boolean:i=e.PrimitiveType.Boolean;break;case t.SemanticType.Date:i=e.PrimitiveType.Date;break;case t.SemanticType.DateTime:i=e.PrimitiveType.DateTime;break;case t.SemanticType.Time:i=e.PrimitiveType.Time;break;case t.SemanticType.Year:i=e.PrimitiveType.Integer,n="Year";break;case t.SemanticType.Month:i=e.PrimitiveType.Integer,n="Month"}return e.ValueType.fromPrimitiveTypeAndCategory(i,n)}function Y(e,t,r){for(var n=0,i=e.length;i>n;n++){var a=e[n],o=a.Projection,u=a.Name,s=t[o];void 0===s&&($(t,o),s=t[o]={});var c=s.roles;void 0===s.roles&&(c=s.roles={}),c[u]=!0;var l=r[u];void 0===l&&(l=r[u]=[]),l.push(o)}}function $(e,t){for(var r=e.length;t>r;r++)e[r]={}}function J(e){var t={},r={selects:t};if(e)for(var n=0,i=e.length;i>n;n++){var a=e[n];t[a.Projection]=!0}return r}function Z(e,t,r){void 0===e&&(e=[]);var n=e;return X(e),t&&(n.identityFields=t),r&&(n.source=r),n}function X(e,t){e.grouped=t?function(){return t}:function(){return ee(e)}}function ee(e){for(var t,r=[],n=0,i=e.length;i>n;n++){var a=e[n];if(!t||t.identity!==a.identity){if(t={values:[]},a.identity){t.identity=a.identity;var o=a.source;void 0!==o.groupName?t.name=o.groupName:o.displayName&&(t.name=o.displayName)}r.push(t)}t.values.push(a)}return r}function te(e,r){var n;switch(re(e.categorical,r)){case 1:n=t.DataViewPivotCategorical.apply(e);break;case 2:n=t.DataViewSelfCrossJoin.apply(e)}return n||e}function re(e,t){if(e&&!_.isEmpty(t)){var r=e.categories;if(r&&1===r.length){var n=e.values;if(!_.isEmpty(n)&&!n.grouped().some(function(e){return!!e.identity}))for(var i=r[0].source.roles,a=0,o=t.length;o>a;a++){var u=t[a].categorical;if(u&&oe(i,u.values)){var s=u.categories,c=ie(i,s)||ae(i,s);return c?2:1}}}}}function ne(e,t){if(e&&!_.isEmpty(t)){var r=e.rows.levels;if(!(r.length<1)){var n=e.rows.root.children;if(n&&0!==n.length)for(var i=r[0].sources[0].roles,a=0,o=t.length;o>a;a++){var u=t[a].matrix;if(u&&!ae(i,u.rows)&&ae(i,u.columns))return!0}}}}function ie(e,t){return e&&t&&t.bind?e[t.bind.to]:void 0}function ae(e,t){return e&&t&&t["for"]?e[t["for"]["in"]]:void 0}function oe(e,t){return e&&t&&t.group?e[t.group.by]:void 0}r.apply=u,r.upgradeSettingsToObjects=h,r.createTransformActions=G,r.createValueColumns=Z}(r=t.DataViewTransform||(t.DataViewTransform={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r,n=e.Prototype.inheritSingle;!function(t){function r(e){var t=_.filter(e.dataRoles,function(e){return!_.isEmpty(e.requiredTypes)});i(e.dataview,e.dataViewMappings,t)}function i(e,t,r){if(!_.isEmpty(t)&&!_.isEmpty(r)){for(var n=a(e.metadata.columns,r),i=o(e.metadata.columns,r),u={},s=0;s<t.length;s++){var v=t[s];for(var y in v)null!=e[y]&&(u[y]=!0)}u.categorical&&c(e.categorical,n,i),u.table&&l(e.table,n,i),u.tree&&p(e.tree.root,n,i),u.matrix&&f(e.matrix,n,i),u.single&&h(e,t,r,i)}}function a(e,t){if(!e||!t)return function(){return!1};for(var r={},n=0;n<e.length;n++){var i=e[n],a=i.roles;if(a)for(var o=0;o<t.length;o++){var u=t[o];if(a[u.name]){r[i.index]=!0;break}}}return function(e){return isNaN(e)?!1:!!r[e]}}function o(e,t){if(!e||!t)return function(){return!0};for(var r=[],n=0;n<e.length;n++){var i=e[n],a=u(i,t);a&&(r[i.index]=a)}return function(e,t){return r[e]?r[e](t):!0}}function u(e,t){var r=s(e,t);if(!_.isEmpty(r))return function(e){return d(e,r)}}function s(t,r){var n=[],i=t&&t.roles;if(!i)return n;for(var a=0;a<r.length;a++){var o=r[a];if(i[o.name])for(var u=0,s=o.requiredTypes;u<s.length;u++){var c=s[u],l=e.ValueType.fromDescriptor(c);n.push(l)}}return n}function c(e,t,r){var n=e&&e.values;if(n){var i=n.grouped();if(i)for(var a=0;a<i.length;a++)for(var o=i[a],u=o.values,s=0;s<u.length;s++){var c=u[s],l=c.source.index;if(t(l))for(var p=0,f=c.values.length;f>p;p++)c.values=y(c.values,p,l,r)}}}function l(e,t,r){var n=e&&e.columns;if(n){for(var i=[],a=0;a<n.length;a++){var o=n[a];t(o.index)&&i.push(o.index)}for(var u=e.rows,s=0,c=u.length;c>s;s++)for(var l=0;l<i.length;l++){var p=i[l];u[s]=y(u[s],p,p,r)}}}function p(e,t,r){if(e.values)for(var n in e.values)t(n)&&("object"==typeof e.values[n]&&"value"in e.values[n]?e.values[n]=y(e.values[n],"value",n,r):e.values=y(e.values,n,n,r));else if(e.children)for(var i=0,a=e.children;i<a.length;i++){var o=a[i];p(o,t,r)}}function f(e,t,r){var n=e&&e.rows&&e.rows.root;n&&v(e,n,t,r)}function v(e,t,r,n){if(t.values)for(var i in t.values){var a=t.values[i],o=a.valueSourceIndex||0,u=e.valueSources[o].index;_.isNumber(u)&&r(u)&&(t.values[i]=y(a,"value",u,n))}else if(t.children)for(var s=0,c=t.children;s<c.length;s++){var l=c[s];v(e,l,r,n)}}function h(e,t,r,n){if(e.single){for(var i=[],a=0;a<r.length;a++){var o=r[a];o.name&&i.push(o.name)}for(var u=e.metadata.columns,s=0;s<t.length;s++){var c=t[s],l=c.single.role;if(-1!==i.indexOf(l)){var p=g(u,l);return void(p&&(e.single=y(e.single,"value",p.index,n)))}}}}function y(e,t,r,i){if(e){var a=e[t];return null===a||i(r,a)||(e=n(e),e[t]=null),e}}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];if(n.numeric||n.integer)return"number"==typeof e}return!1}function g(e,t){for(var r=0;r<e.length;r++){var n=e[r],i=n&&n.roles;if(i&&i[t])return n}}t.apply=r,t.filterVariantMeasures=i,t.generateMetadataColumnFilter=a,t.generateValueFilter=o,t.getColumnRequiredTypes=s,t.normalizeVariant=y}(r=t.DataViewNormalizeValues||(t.DataViewNormalizeValues={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(e){return function(t){return t.get(e)}}function r(e,t){return"function"==typeof e?e(t):"string"==typeof e?e:void 0}e.createDisplayNameGetter=t,e.getDisplayName=r}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){!function(e){e[e.Year=0]="Year",e[e.Month=1]="Month",e[e.Week=2]="Week",e[e.Day=3]="Day",e[e.Hour=4]="Hour",e[e.Minute=5]="Minute",e[e.Second=6]="Second",e[e.Millisecond=7]="Millisecond"}(e.DateTimeUnit||(e.DateTimeUnit={}));e.DateTimeUnit}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(e){return r(e)||u(e)||s(e)||i(e)||a(e)||c(e)||o(e)||l(e)}function r(t){var r=t.columnAggr;if(r){var n=l(t.columnAggr);return e.aggregate(e.columnRef(n,r.name),r.aggregate)}}function i(t){var r=t.hierarchyLevel;if(r){var n=e.hierarchy(l(r),r.name);return e.hierarchyLevel(n,r.level)}}function a(t){var r=t.hierarchy;if(r){var n=l(r);return e.hierarchy(n,r.name)}}function o(t){var r=t.columnHierarchyLevelVariation;if(r){var n=l(r.source);return e.propertyVariationSource(n,r.source.name,r.level.name)}}function u(t){var r=t.column;if(r){var n=l(t.column);return e.columnRef(n,r.name)}}function s(t){var r=t.measure;if(r){var n=l(t.measure);return e.measureRef(n,r.name)}}function c(t){var r=t.entityAggr;if(r){var n=l(t.entityAggr);return e.aggregate(n,r.aggregate)}}function l(t){var r=n.toFieldExprEntityItemPattern(t);return e.entity(r.schema,r.entity,r.entityVar)}e.fieldExpr=t}(t=e.SQExprBuilder||(e.SQExprBuilder={}));var r;!function(t){function r(t){return t instanceof e.SQEntityExpr?{entity:t.entity,schema:t.schema}:t.accept(i.instance)}t.asFieldPattern=r}(r=e.SQExprConverter||(e.SQExprConverter={}));
var n,i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.visitColumnRef=function(e){var t=e.source.accept(a.instance);if(t&&t.entity){var r=t.entity;return r.name=e.ref,{column:r}}},t.prototype.visitMeasureRef=function(e){var t=e.source.accept(a.instance);if(t&&t.entity){var r=t.entity;return r.name=e.ref,{measure:r}}},t.prototype.visitAggr=function(e){var t=e.arg.accept(this);if(t&&t.column){var r=t.column;return r.aggregate=e.func,{columnAggr:r}}if(t&&t.columnAggr){var r=t.columnAggr;return r.aggregate=e.func,{columnAggr:r}}if(t&&t.hierarchyLevel){var r=t.hierarchyLevel;return r.aggregate=e.func,{hierarchyLevelAggr:r}}var n=e.arg.accept(a.instance);if(n&&n.entity){var r=n.entity;return r.aggregate=e.func,{entityAggr:r}}},t.prototype.visitHierarchy=function(e){var t=e.arg.accept(a.instance);if(t&&t.entity){var r=t.entity;return r.name=e.hierarchy,{hierarchy:r}}},t.prototype.visitHierarchyLevel=function(e){var t=e.arg.accept(o.instance);if(t){var r;return t.hierarchy&&(r={entity:t.hierarchy.entity,schema:t.hierarchy.schema,name:t.hierarchy.name,level:e.level}),t.variation?{columnHierarchyLevelVariation:{source:{entity:t.variation.column.entity,schema:t.variation.column.schema,name:t.variation.column.name},level:r,variationName:t.variation.variationName}}:{hierarchyLevel:r}}},t.instance=new t,t}(e.DefaultSQExprVisitor),a=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype.visitEntity=function(e){var t={schema:e.schema,entity:e.entity};return e.variable&&(t.entityVar=e.variable),{entity:t}},r.prototype.visitPropertyVariationSource=function(t){var r=t.arg;if(r instanceof e.SQEntityExpr){var n={schema:r.schema,entity:r.entity,name:t.property};return r.variable&&(n.entityVar=r.variable),{variation:{column:n,variationName:t.name}}}},r.instance=new r,r}(e.DefaultSQExprVisitor),o=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.visitHierarchy=function(e){var t,r,n=e.arg.accept(a.instance);return n.variation?(t={name:e.hierarchy,schema:n.variation.column.schema,entity:n.variation.column.entity},r=n.variation):t={name:e.hierarchy,schema:n.entity.schema,entity:n.entity.entity},{hierarchy:t,variation:r}},t.instance=new t,t}(e.DefaultSQExprVisitor);!function(e){function t(e){return void 0!==(e.column||e.columnAggr||e.measure)}function r(e){var t=e.column||e.columnAggr||e.measure;return t?t.name:void 0}function n(e){var t=e.hierarchy;return t?t.name:void 0}function i(e){return e.columnHierarchyLevelVariation?e.columnHierarchyLevelVariation.source:e.column||e.measure||e.columnAggr}function a(e){var t=r(e);return t?t:o(e).entity}function o(e){var t=e.column||e.columnAggr||e.entityAggr||e.hierarchy||e.hierarchyLevel||e.hierarchyLevelAggr||e.measure||e.columnHierarchyLevelVariation&&e.columnHierarchyLevelVariation.source||e;return{schema:t.schema,entity:t.entity,entityVar:t.entityVar}}e.hasFieldExprName=t,e.getPropertyName=r,e.getHierarchyName=n,e.getColumnRef=i,e.getFieldExprName=a,e.toFieldExprEntityItemPattern=o}(n=e.FieldExprPattern||(e.FieldExprPattern={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function r(t,r){if(!r||0===r.length)return{dataView:t,isValid:!0};if(t)for(var u=0;u<r.length;u++){var s=r[u];if(c(t,s))return{dataView:t,isValid:!0};if(s.categorical&&t.categorical)return n(t,s);if(s.tree&&t.tree)return a(t,s.tree);if(s.single&&t.single)return i(t,s.single);if(s.table&&t.table)return o(t,s.table)}else if(e.ScriptResultUtil.findScriptResult(r))return{dataView:t,isValid:!0};return{isValid:!1}}function n(t,r){var n=r.categorical,i=t.categorical;if(!i)return{isValid:!1};var a;if(n.rowCount&&(a=n.rowCount.supported,a&&a.max)){var o,u=i.categories,s=a.max,c=void 0;if(u)for(var p=0,f=u.length;f>p;p++){var v=u[p];if(c=v.values.length,void 0!==s&&c>s){var h=V.range(v.values,0,s-1);o=o||{categories:[]},o.categories.push({source:v.source,values:h})}}if(i.values&&i.values.length>0&&s&&(c||(c=i.values[0].values.length),void 0!==s&&c>s)){o=o||{},o.values=e.data.DataViewTransform.createValueColumns();for(var p=0,f=i.values.length;f>p;p++){var y=i.values[p],d={source:y.source,values:V.range(y.values,0,s-1)};void 0!==y.min&&(d.min=y.min),void 0!==y.max&&(d.max=y.max),void 0!==y.subtotal&&(d.subtotal=y.subtotal),o.values.push(d)}}o&&(t={metadata:t.metadata,categorical:o})}return l(t,r)?{dataView:t,isValid:!0}:null}function i(e,t){return e.single?{dataView:e,isValid:!0}:{isValid:!1}}function a(e,t){var r=e.metadata;return y(u(r.columns),t.depth)?{dataView:e,isValid:!0}:{isValid:!1}}function o(e,t){return e.table?{dataView:e,isValid:!0}:{isValid:!1}}function u(e){for(var t=0,r=0,n=e.length;n>r;r++)e[r].isMeasure||++t;return t}function s(e){for(var t=0,r=0,n=e.length;n>r;r++)e[r].isMeasure&&++t;return t}function c(e,t,r){return t&&e?t.scriptResult&&!h(e.scriptResult,t.scriptResult)?!1:t.categorical&&!l(e,t.categorical,r)?!1:t.tree&&!f(e,t.tree)?!1:t.single&&!p(e.single,t.single)?!1:t.table&&!v(e.table,t.table,r)?!1:!0:!1}function l(e,t,r){var n=e.categorical;if(!n)return!1;if(t.rowCount){var i=t.rowCount.supported;if(r&&t.rowCount.preferred&&(i=t.rowCount.preferred),i){var a=0;if(n.values&&n.values.length?a=n.values[0].values.length:n.categories&&n.categories.length&&(a=n.categories[0].values.length),!y(a,i))return!1}}return!0}function p(e,t){return e?!0:!1}function f(e,t){var r=e.metadata;return y(u(r.columns),t.depth)}function v(e,t,r){if(!e)return!1;if(t.rowCount){var n=t.rowCount.supported;if(r&&t.rowCount.preferred&&(n=t.rowCount.preferred),n){var i=0;if(e.rows&&e.rows.length&&(i=e.rows.length),!y(i,n))return!1}}return!0}function h(e,t){return e&&e.imageBase64?!0:!1}function y(e,t,r){return t?!r&&void 0!==t.min&&t.min>e?!1:void 0!==t.max&&t.max<e?!1:!0:0===e}function d(e,t,r,n){if(!e||void 0===e.kind)return!0;var i=e.kind,a=r[t];if(a)for(var o=a.all(),u=0;u<o.length;u++){var s=o[u];if(n[s.queryRef]!==i)return!1}return!0}function g(e,t,r,n,i){for(var a=[],o=0,u=t.length;u>o;o++){var s=t[o],c=s.conditions,l=s.requiredProperties,p=m(c,e,r),f=x(l,n,i);p&&f&&a.push(s)}return V.emptyToNull(a)}function m(e,t,r){return _.isEmpty(e)?!0:_.some(e,function(e){return b(t,e,r)})}function x(t,r,n){if(_.isEmpty(t))return!0;if(!r||!n)return!1;var i=e.data.createStaticEvalContext();return _.every(t,function(t){var a=null,o=r[t.objectName];o&&(a=o.properties[t.propertyName]);var u=T.getValue(n,t,null);return a&&u?e.data.DataViewObjectEvaluator.evaluateProperty(i,a,u):!1})}function b(e,t,r){for(var n=Object.keys(t),i=0,a=n.length;a>i;i++){var o=n[i],u=e[o]&&!_.isEmpty(e[o].activeProjectionRefs),s=t[o],c=w(o,e,u);if(!y(c,s)||!d(s,o,e,r))return!1}return!0}function w(e,t,r){var n=t[e];return n?r?1:n.all().length:0}function E(t,r){if(t&&r&&t.categorical&&r.categorical){var n=t.categorical.categories,i=r.categorical.categories;if(n&&i&&n.length===i.length){for(var a=0,o=n.length;o>a;a++){var u=n[a].identity,s=i[a].identity,c=S(u);if(c!==S(s))return!1;for(var l=0;c>l;l++)if(!e.DataViewScopeIdentity.equals(u[l],s[l]))return!1}return!0}}return!1}function S(e){return e?e.length:0}function C(e,t){return e||t?e&&t?e.displayName!==t.displayName?!1:e.queryName!==t.queryName?!1:e.isMeasure!==t.isMeasure?!1:e.type!==t.type?!1:e.sort!==t.sort?!1:!0:!1:!0}function D(e,r){if(!e&&!r)return!0;if(!e||!r)return!1;var n=e.columns.length,i=r.columns.length;if(n!==i)return!1;for(var a=0;i>a;a++)if(!t.areMetadataColumnsEquivalent(e.columns[a],r.columns[a]))return!1;return!0}var V=jsCommon.ArrayExtensions,T=e.data.DataViewObjectDefinitions;t.validateAndReshape=r,t.countGroups=u,t.countMeasures=s,t.supports=c,t.conformsToRange=y,t.chooseDataViewMappings=g,t.getPropertyCount=w,t.hasSameCategoryIdentity=E,t.areMetadataColumnsEquivalent=C,t.isMetadataEquivalent=D}(t=e.DataViewAnalysis||(e.DataViewAnalysis={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function n(e,t,n){return e=e||null,t=t||null,e===t?!0:!e!=!t?!1:r.SQExpr.equals(e.expr,t.expr,n)}function i(e,t){if(!_.isEmpty(e)){for(var r=[],n=0;n<e.length;n++){var i=e[n];r.push(i.expr)}return a(r,t)}}function a(t,n){if(!_.isEmpty(t)){for(var i,a=0;a<t.length;a++){var o=t[a],u=r.ScopeIdentityExtractor.getInExpr(o);i=i?r.SQExprBuilder.or(i,u):u||o}return i&&n&&(i=e.data.SQExprBuilder.not(i)),e.data.SemanticFilter.fromSQExpr(i)}}t.equals=n,t.filterFromIdentity=i,t.filterFromExprs=a}(t=e.DataViewScopeIdentity||(e.DataViewScopeIdentity={}));var r;!function(e){function t(e){return new n(e)}var r=jsCommon.Lazy;e.createDataViewScopeIdentity=t;var n=function(){function t(t){this._expr=t,this._key=new r(function(){return e.SQExprShortSerializer.serialize(t)})}return Object.defineProperty(t.prototype,"expr",{get:function(){return this._expr},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this._key.getValue()},enumerable:!0,configurable:!0}),t}()}(r=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t,r=jsCommon.Lazy;!function(t){function n(t,r){var n=e.ScopeIdentityExtractor.getKeys(r.expr);return n?e.SQExprUtils.sequenceEqual(t.exprs,n):!1}function i(e){return new a(e)}t.matches=n,t.fromExprs=i;var a=function(){function t(t){this._exprs=t,this._key=new r(function(){return e.SQExprShortSerializer.serializeArray(t)})}return Object.defineProperty(t.prototype,"exprs",{get:function(){return this._exprs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this._key.getValue()},enumerable:!0,configurable:!0}),t}()}(t=e.DataViewScopeWildcard||(e.DataViewScopeWildcard={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(e,t){return new i(e,t)}function r(e,t){return n(e.values,t)||n(e.categories,t)}function n(e,t){if(e)for(var r=0;r<e.length;r++){var n=e[r],i=n.source.roles;if(i&&i[t])return n}}e.createCategoricalEvalContext=t;var i=function(){function e(e,t){this.dataView=e,this.identities=t,this.columnsByRole={}}return e.prototype.getCurrentIdentity=function(){var e=this.identities,t=this.index;return e&&null!=t?e[t]:void 0},e.prototype.getExprValue=function(e){},e.prototype.getRoleValue=function(e){var t=this.columnsByRole,n=t[e];if(n||(n=t[e]=r(this.dataView,e)),n){var i=this.index;return null!=i?n.values[this.index]:void 0}},e.prototype.setCurrentRowIndex=function(e){this.index=e},e}()}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function e(){}return e.prototype.evaluate=function(e){},e}();e.RuleEvaluation=t}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(e){function t(t,r){e.call(this),this.inputRole=t,this.allocator=r}return __extends(t,e),t.prototype.evaluate=function(e){var t=e.getRoleValue(this.inputRole);return void 0!==t?this.allocator.color(t):void 0},t}(e.RuleEvaluation);e.ColorRuleEvaluation=t}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r=function(t){function r(e){t.call(this),this.selection=e}return __extends(r,t),r.prototype.evaluate=function(t){for(var r=t.getCurrentIdentity(),n=this.selection.scopeIds,i=0,a=n.length;a>i;i++)if(e.DataViewScopeIdentity.equals(r,n[i]))return!this.selection.isNot},r}(t.RuleEvaluation);t.FilterRuleEvaluation=r}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t,r=jsCommon.StringExtensions,n=e.data.DefaultSQExprVisitor,i=e.data.SQExprConverter,a=e.data.FieldExprPattern;!function(t){function o(e){return e&&1===e.length?e[0].scriptResult:void 0}function u(t){var r=o(t);if(r){var n=t[0].metadata.objects,i=e.DataViewObjects.getValue(n,r.script.source),a=e.DataViewObjects.getValue(n,r.script.provider);return{source:i,provider:a}}}function s(t,r){var n=o(t);if(n&&r){var i=e.data.DataViewObjectDefinitions.getValue(r,n.script.source,null),a=e.data.DataViewObjectDefinitions.getValue(r,n.script.provider,null);return{source:i?i.value:null,provider:a?a.value:null}}}function c(e,t,n){var i={VariableName:"dataset",Columns:[]};if(e&&t&&!_.isEmpty(t)){var a=[],o=[];for(var u in e)for(var s=0,c=e[u].all();s<c.length;s++){var p=c[s],f=t.withName(p.queryRef);if(f){var v={QueryName:f.name,Name:f.expr.accept(new l(n))};o.push(v),a.push(v.Name)}}a=r.ensureUniqueNames(a);for(var h=0;h<a.length;h++){var v=o[h];v.Name=a[h]}i.Columns=o}return i}t.findScriptResult=o,t.extractScriptResult=u,t.extractScriptResultFromVisualConfig=s,t.getScriptInput=c;var l=function(e){function t(t){e.call(this),this.federatedSchema=t}return __extends(t,e),t.prototype.visitEntity=function(e){return e.entity},t.prototype.visitColumnRef=function(e){return t.getNameForProperty(e,this.federatedSchema)},t.prototype.visitMeasureRef=function(e){return t.getNameForProperty(e,this.federatedSchema)},t.prototype.visitAggr=function(e){return t.getNameForAggregate(e,this.federatedSchema)},t.prototype.visitHierarchy=function(e){return t.getNameForHierarchy(e,this.federatedSchema)},t.prototype.visitHierarchyLevel=function(e){return t.getNameForHierarchyLevel(e,this.federatedSchema)},t.getNameForProperty=function(e,t){var r=i.asFieldPattern(e),n=r.column||r.measure,a=t.schema(n.schema),o=a.findProperty(n.entity,n.name);return o?o.name:void 0},t.getNameForAggregate=function(e,t){var r=i.asFieldPattern(e),n=r.columnAggr||r.entityAggr,o=t.schema(n.schema).entities.withName(n.entity);if(o){var u=o.properties.withName(a.getFieldExprName(r));return u.name}},t.getNameForHierarchy=function(e,t){var r=i.asFieldPattern(e),n=r.hierarchy;if(n){var a=t.schema(n.schema),o=a.findHierarchy(n.entity,n.name);if(o)return o.name}},t.getNameForHierarchyLevel=function(e,r){var n=i.asFieldPattern(e);return n.columnHierarchyLevelVariation?t.getVariationLevelName(e,r):void 0},t.getVariationLevelName=function(e,t){var r=i.asFieldPattern(e),n=a.toFieldExprEntityItemPattern(r);if(r.columnHierarchyLevelVariation){var o=t.schema(n.schema).findProperty(n.entity,r.columnHierarchyLevelVariation.source.name);if(!o)return;for(var u=o.column.variations,s=0;s<u.length;s++){var c=u[s];if(c.name===r.columnHierarchyLevelVariation.variationName)for(var l=0,p=c.defaultHierarchy.levels;l<p.length;l++){var f=p[l];if(f.name===r.columnHierarchyLevelVariation.level.level)return f.column.name}}}},t}(n)}(t=e.ScriptResultUtil||(e.ScriptResultUtil={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r;!function(t){var r;!function(t){function r(t,r){!e.DataViewAnalysis.isMetadataEquivalent(t.metadata,r.metadata),r.metadata.segment||delete t.metadata.segment,t.table&&r.table&&n(t.table,r.table),t.categorical&&r.categorical&&i(t.categorical,r.categorical),t.tree&&r.tree&&o(t.tree.root,r.tree.root,!0),t.matrix&&r.matrix&&o(t.matrix.rows.root,r.matrix.rows.root,!1)}function n(e,t){0!==t.rows.length&&a(e.rows,t.rows,t.lastMergeIndex+1)}function i(e,t){if(e.categories&&t.categories)for(var r=t.categories.length,n=0;r>n;n++){var i=t.categories[n],o=e.categories[n];!o.values&&i.values&&(o.values=[]),i.values&&a(o.values,i.values,t.lastMergeIndex+1),!o.identity&&i.identity&&(o.identity=[]),i.identity&&a(o.identity,i.identity,t.lastMergeIndex+1)}if(e.values&&t.values)for(var u=t.values.length,s=0;u>s;s++){var c=t.values[s],l=e.values[s];!l.values&&c.values&&(l.values=[]),c.values&&a(l.values,c.values,t.lastMergeIndex+1),c.highlights&&a(l.highlights,c.highlights,t.lastMergeIndex+1)}}function a(e,t,r){if(r>=t.length)return t;var n=[];return void 0!==r&&(n=t.splice(0,r)),Array.prototype.push.apply(e,t),n}function o(e,t,r){if(t.children&&0!==t.children.length){if(r&&(!e.children||0===e.children.length))return void(e.children=t.children);var n=u(t.children),i=e.children[e.children.length-1],s=a(e.children,t.children,n);s.length>0&&o(i,s[s.length-1],r)}}function u(e){if(0===e.length)return 0;for(var t=0;t<e.length;t++){var r=e[t];if(!r.isMerge)break}return t}t.mergeDataViews=r,t.mergeTables=n,t.mergeCategorical=i,t.mergeTreeNodes=o}(r=t.DataViewMerger||(t.DataViewMerger={}))}(r=t.segmentation||(t.segmentation={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=jsCommon.ArrayExtensions,r=function(){function r(){}return r.prototype.visitColumnRef=function(t){var r=t.source,n=r.accept(this);return r===n?t:new e.SQColumnRefExpr(n,t.ref)},r.prototype.visitMeasureRef=function(t){var r=t.source,n=r.accept(this);return r===n?t:new e.SQMeasureRefExpr(n,t.ref)},r.prototype.visitAggr=function(t){var r=t.arg,n=r.accept(this);return r===n?t:new e.SQAggregationExpr(n,t.func)},r.prototype.visitHierarchy=function(t){var r=t.arg,n=r.accept(this);return r===n?t:new e.SQHierarchyExpr(n,t.hierarchy)},r.prototype.visitHierarchyLevel=function(t){var r=t.arg,n=r.accept(this);return r===n?t:new e.SQHierarchyLevelExpr(n,t.level)},r.prototype.visitPropertyVariationSource=function(t){var r=t.arg,n=r.accept(this);return r===n?t:new e.SQPropertyVariationSourceExpr(n,t.name,t.property)},r.prototype.visitEntity=function(e){return e},r.prototype.visitAnd=function(t){var r=t.left,n=r.accept(this),i=t.right,a=i.accept(this);return r===n&&i===a?t:new e.SQAndExpr(n,a)},r.prototype.visitBetween=function(t){var r=t.arg,n=r.accept(this),i=t.lower,a=i.accept(this),o=t.upper,u=o.accept(this);return r===n&&i===a&&o===u?t:new e.SQBetweenExpr(n,a,u)},r.prototype.visitIn=function(r){for(var n,i=r.args,a=this.rewriteAll(i),o=r.values,u=0,s=o.length;s>u;u++){var c=o[u],l=this.rewriteAll(c);c===l||n||(n=t.take(o,u)),n&&n.push(l)}return i!==a||n?new e.SQInExpr(a,n||o):r},r.prototype.rewriteAll=function(e){for(var r,n=0,i=e.length;i>n;n++){var a=e[n],o=a.accept(this);a===o||r||(r=t.take(e,n)),r&&r.push(o)}return r||e},r.prototype.visitOr=function(t){var r=t.left,n=r.accept(this),i=t.right,a=i.accept(this);return r===n&&i===a?t:new e.SQOrExpr(n,a)},r.prototype.visitCompare=function(t){var r=t.left,n=r.accept(this),i=t.right,a=i.accept(this);return r===n&&i===a?t:new e.SQCompareExpr(t.comparison,n,a)},r.prototype.visitContains=function(t){var r=t.left,n=r.accept(this),i=t.right,a=i.accept(this);return r===n&&i===a?t:new e.SQContainsExpr(n,a)},r.prototype.visitExists=function(t){var r=t.arg,n=r.accept(this);return r===n?t:new e.SQExistsExpr(n)},r.prototype.visitNot=function(t){var r=t.arg,n=r.accept(this);return r===n?t:new e.SQNotExpr(n)},r.prototype.visitStartsWith=function(t){var r=t.left,n=r.accept(this),i=t.right,a=i.accept(this);return r===n&&i===a?t:new e.SQStartsWithExpr(n,a)},r.prototype.visitConstant=function(e){return e},r.prototype.visitDateSpan=function(t){var r=t.arg,n=r.accept(this);return r===n?t:new e.SQDateSpanExpr(t.unit,n)},r.prototype.visitDateAdd=function(t){var r=t.arg,n=r.accept(this);return r===n?t:new e.SQDateAddExpr(t.unit,t.amount,n)},r.prototype.visitNow=function(e){return e},r.prototype.visitDefaultValue=function(e){return e},r.prototype.visitAnyValue=function(e){return e},r}();e.SQExprRewriter=r}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(t){function r(e){return e.accept(new n)}t.run=r;var n=function(t){function r(){t.call(this)}return __extends(r,t),r.prototype.visitCompare=function(t){if(t.comparison!==e.QueryComparisonKind.Equal)return this.visitUnsupported(t);if(!this.isSupported(t.left)||!this.isSupported(t.right))return this.visitUnsupported(t);var r=this.isComparand(t.left),n=this.isComparand(t.right);if(r===n)return this.visitUnsupported(t);var i=r?t.left:t.right,a=r?t.right:t.left,o=this.current;return o?(o.add(i,a),t):e.SQExprBuilder.inExpr([i],[[a]])},r.prototype.visitOr=function(e){if(!this.isSupported(e.left)||!this.isSupported(e.right))return this.visitUnsupported(e);var t;return this.current||(t=this.current=new i),e.left.accept(this),e.right.accept(this),t?(this.current=null,t.complete()||e):e},r.prototype.visitAnd=function(e){if(!this.isSupported(e.left)||!this.isSupported(e.right))return this.visitUnsupported(e);var r=this.current;return r?(r.cancel(),e):t.prototype.visitAnd.call(this,e)},r.prototype.visitUnsupported=function(e){var t=this.current;return t&&t.cancel(),e},r.prototype.isSupported=function(t){return t instanceof e.SQCompareExpr||t instanceof e.SQColumnRefExpr||t instanceof e.SQConstantExpr||t instanceof e.SQHierarchyLevelExpr||t instanceof e.SQOrExpr||t instanceof e.SQAndExpr},r.prototype.isComparand=function(t){return t instanceof e.SQColumnRefExpr||t instanceof e.SQHierarchyLevelExpr},r}(e.SQExprRewriter),i=function(){function t(){}return t.prototype.add=function(t,r){if(!this.cancelled){if(this.operand&&!e.SQExpr.equals(t,this.operand))return void this.cancel();this.operand=t;var n=this.values;n||(n=this.values=[]),n.push(r)}},t.prototype.cancel=function(){this.cancelled=!0},t.prototype.complete=function(){return!this.cancelled&&this.operand?e.SQExprBuilder.inExpr([this.operand],_.map(this.values,function(e){return[e]})):void 0},t}()}(t=e.EqualsToInRewriter||(e.EqualsToInRewriter={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r;!function(e){function t(e,t){var r=e.conditions(),i=r[0];if(i){var a=new n(t);if(i.accept(a))return a.getResult()}}function r(e){var t=e.expr.accept(new i);return t?t.value:void 0}e.asScopeIdsContainer=t,e.getFirstComparandValue=r}(r=t.SQExprConverter||(t.SQExprConverter={}));var n=function(r){function n(e){r.call(this),this.isRoot=!0,this.isNot=!1,this.keyExprsCount=null,this.valueExprs=[],this.fieldExprs=[];for(var n=0;n<e.length;n++){var i=e[n];this.fieldExprs.push(t.SQExprBuilder.removeEntityVariables(i))}}return __extends(n,r),n.prototype.getResult=function(){for(var t=this.valueExprs,r=[],i=this.keyExprsCount||1,a=0,o=i,u=t.length;u>a&&u>=o;){var s=t.slice(a,o),c=n.getScopeIdentity(this.fieldExprs,s);jsCommon.ArrayExtensions.isInArray(r,c,e.DataViewScopeIdentity.equals)||r.push(c),a+=i,o+=i}return{isNot:this.isNot,scopeIds:r}},n.getScopeIdentity=function(e,r){for(var n,i=0,a=e.length;a>i;i++){var o=t.SQExprBuilder.equal(e[i],r[i]);n=n?t.SQExprBuilder.and(n,o):o}return t.createDataViewScopeIdentity(n)},n.prototype.visitOr=function(e){return null!==this.keyExprsCount?this.unsupportedSQExpr():(this.isRoot=!1,e.left.accept(this)&&e.right.accept(this))},n.prototype.visitNot=function(e){return this.isRoot?(this.isNot=!0,e.arg.accept(this)):this.unsupportedSQExpr()},n.prototype.visitConstant=function(t){return this.isRoot&&t.type.primitiveType===e.PrimitiveType.Null?this.unsupportedSQExpr():(this.valueExprs.push(t),!0)},n.prototype.visitCompare=function(e){return null!==this.keyExprsCount?this.unsupportedSQExpr():(this.isRoot=!1,e.comparison!==t.QueryComparisonKind.Equal?this.unsupportedSQExpr():e.left.accept(this)&&e.right.accept(this))},n.prototype.visitIn=function(e){this.keyExprsCount=0;var t;this.isRoot=!1;for(var r=0,n=e.args;r<n.length;r++){var i=n[r];if(t=i.accept(this),!t)return this.unsupportedSQExpr();this.keyExprsCount++}if(this.keyExprsCount!==this.fieldExprs.length)return this.unsupportedSQExpr();for(var a=e.values,o=0;o<a.length;o++)for(var u=a[o],s=(u.length,0);s<u.length;s++){var c=u[s];if(t=c.accept(this),!t)return this.unsupportedSQExpr()}return t},n.prototype.visitColumnRef=function(e){if(this.isRoot)return this.unsupportedSQExpr();var r=t.SQExprBuilder.removeEntityVariables(e);return null!==this.keyExprsCount?t.SQExpr.equals(this.fieldExprs[this.keyExprsCount],r):t.SQExpr.equals(this.fieldExprs[0],r)},n.prototype.visitDefaultValue=function(e){return this.isRoot||null!==this.keyExprsCount?this.unsupportedSQExpr():(this.valueExprs.push(e),!0)},n.prototype.visitAnyValue=function(e){return this.isRoot||null!==this.keyExprsCount?this.unsupportedSQExpr():(this.valueExprs.push(e),!0)},n.prototype.visitDefault=function(e){return this.unsupportedSQExpr()},n.prototype.unsupportedSQExpr=function(){return!1},n}(t.DefaultSQExprVisitor),i=function(e){function r(){e.apply(this,arguments)}return __extends(r,e),r.prototype.visitAnd=function(e){return e.left.accept(this)||e.right.accept(this)},r.prototype.visitCompare=function(e){if(e.comparison===t.QueryComparisonKind.Equal){if(e.right instanceof t.SQConstantExpr)return e.right;if(e.left instanceof t.SQConstantExpr)return e.left}},r}(t.DefaultSQExprVisitor)}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t,r=jsCommon.ArrayExtensions;!function(t){function n(e){var t=new a;return e.accept(t),t.malformed?null:r.emptyToNull(t.keys)}function i(t){var n=new a;if(t.accept(n),!n.malformed){var i=r.emptyToNull(n.keys),o=r.emptyToNull(n.values);return i&&o?e.SQExprBuilder.inExpr(i,[o]):void 0}}t.getKeys=n,t.getInExpr=i;var a=function(t){function r(){t.apply(this,arguments),this.keys=[],this.values=[]}return __extends(r,t),r.prototype.visitAnd=function(e){e.left.accept(this),e.right.accept(this)},r.prototype.visitCompare=function(t){return t.comparison!==e.QueryComparisonKind.Equal?void this.visitDefault(t):(t.left.accept(this),void t.right.accept(this))},r.prototype.visitColumnRef=function(e){this.keys.push(e)},r.prototype.visitHierarchyLevel=function(e){this.keys.push(e)},r.prototype.visitConstant=function(e){this.values.push(e)},r.prototype.visitDefault=function(e){this.malformed=!0},r}(e.DefaultSQExprVisitor)}(t=e.ScopeIdentityExtractor||(e.ScopeIdentityExtractor={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(e){return e+"M"}function r(e){return e+"D"}function n(e){return e+"L"}function i(e){var t=new Date(e.getTime()-6e4*e.getTimezoneOffset()),r=t.toISOString();return jsCommon.StringExtensions.endsWith(r,"Z")&&(r=r.substr(0,r.length-1)),"datetime'"+r+"'"}function a(e){return"'"+e.replace(s,"''")+"'"}function o(){return"null"}function u(e){return e?"true":"false"}var s=/'/g;e.decimal=t,e["double"]=r,e.integer=n,e.dateTime=i,e.text=a,e.nullEncoding=o,e["boolean"]=u}(t=e.PrimitiveValueEncoding||(e.PrimitiveValueEncoding={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(t){function a(r,n){var i=e.FieldExprPattern.toFieldExprEntityItemPattern(n),a=n.hierarchyLevel||n.hierarchyLevelAggr;return a?t.getConceptualHierarchyLevel(r,i.schema,i.entity,a.name,a.level):void 0}function o(e,t,r,n,i){var a=e.schema(t),o=a.findHierarchy(r,n);return o?o.levels.withName(i):void 0}function u(t,r){if(t instanceof e.SQHierarchyExpr){var n=t;if(t.arg instanceof e.SQEntityExpr){var i=t.arg;return r.schema(i.schema).findHierarchy(i.entity,n.hierarchy)}if(t.arg instanceof e.SQPropertyVariationSourceExpr){var a=t.arg,o=a.arg;return r.schema(o.schema).findHierarchyByVariation(o.entity,a.property,a.name,n.hierarchy)}}}function s(e,t,a){return r.convert(t,e)||i.expand(t,e)||!a&&n.expand(t,e)||t}function c(t,r){if(r instanceof e.SQHierarchyExpr||r instanceof e.SQHierarchyLevelExpr)return!0;var n=r.getConceptualProperty(t);if(n){var i=n.column;if(i&&i.variations&&i.variations.length>0)return!0}return!1}function l(t){var r=e.SQExprConverter.asFieldPattern(t);if(r.columnHierarchyLevelVariation){var n=e.SQExprBuilder.entity(r.columnHierarchyLevelVariation.source.schema,r.columnHierarchyLevelVariation.source.entity);return e.SQExprBuilder.columnRef(n,r.columnHierarchyLevelVariation.source.name)}}function p(t){var r=e.SQExprConverter.asFieldPattern(t),n=r.hierarchyLevel;if(n){var i=e.SQExprBuilder.entity(n.schema,n.entity,n.entityVar);return e.SQExprBuilder.hierarchy(i,n.name)}}function f(t){if(t.arg instanceof e.SQHierarchyExpr){var r=t.arg;return r.arg instanceof e.SQPropertyVariationSourceExpr?r.arg:void 0}}function v(t,r,n){if(!(r instanceof e.SQHierarchyLevelExpr&&n instanceof e.SQHierarchyLevelExpr))return!1;var i=r,a=n;if(!e.SQExpr.equals(i.arg,a.arg))return!1;var o=e.SQExprUtils.indexOfExpr(t,i),u=e.SQExprUtils.indexOfExpr(t,a);return-1!==o&&-1!==u&&u>o}function h(e,t,r){for(var n=0;n<t.length&&v(e,t[n],r);)n++;return n}t.getConceptualHierarchyLevelFromExpr=a,t.getConceptualHierarchyLevel=o,t.getConceptualHierarchy=u,t.expandExpr=s,t.isHierarchyOrVariation=c,t.getSourceVariationExpr=l,t.getSourceHierarchy=p,t.getHierarchySourceAsVariationSource=f,t.areHierarchyLevelsOrdered=v,t.getInsertionIndex=h}(t=e.SQHierarchyExprUtils||(e.SQHierarchyExprUtils={}));var r;!function(r){function n(r,n){if(r instanceof e.SQHierarchyExpr){var i=r,a=t.getConceptualHierarchy(i,n);if(a)return _.map(a.levels,function(t){return e.SQExprBuilder.hierarchyLevel(r,t.name)})}}r.convert=n}(r=e.SQExprHierarchyToHierarchyLevelConverter||(e.SQExprHierarchyToHierarchyLevelConverter={}));var n;!function(t){function r(t,r){var n=[];if(t instanceof e.SQHierarchyLevelExpr){var i=e.SQExprConverter.asFieldPattern(t);if(i.hierarchyLevel){var a=e.FieldExprPattern.toFieldExprEntityItemPattern(i),o=r.schema(a.schema).findHierarchy(a.entity,i.hierarchyLevel.name);if(o)for(var u=o.levels,s=0;s<u.length;s++){var c=u[s];if(c.name===i.hierarchyLevel.level){n.push(t);break}n.push(e.SQExprBuilder.hierarchyLevel(e.SQExprBuilder.hierarchy(e.SQExprBuilder.entity(a.schema,a.entity,a.entityVar),o.name),c.name))}}}return _.isEmpty(n)?void 0:n}t.expand=r}(n||(n={}));var i;!function(t){function r(t,r){var n,i=t.getConceptualProperty(r);if(i){var a=i.column;if(a&&a.variations&&a.variations.length>0){var o=a.variations,u=o[0],s=e.SQExprConverter.asFieldPattern(t),c=e.FieldExprPattern.toFieldExprEntityItemPattern(s);if(n=[],u.defaultHierarchy)for(var l=e.SQExprBuilder.hierarchy(e.SQExprBuilder.propertyVariationSource(e.SQExprBuilder.entity(c.schema,c.entity,c.entityVar),u.name,i.name),u.defaultHierarchy.name),p=0,f=u.defaultHierarchy.levels;p<f.length;p++){var v=f[p];n.push(e.SQExprBuilder.hierarchyLevel(l,v.name))}}}return n}t.expand=r}(i||(i={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(t){function r(t,r){for(var i=[],a=0,o=r.length;o>a;a++){var u=r[a];u instanceof e.SQHierarchyLevelExpr?n(t,i,u,a):i.push({expr:u,children:null,selectQueryIndex:a})}return i}function n(t,r,n,i){var a=!0,o=e.SQHierarchyExprUtils.getSourceVariationExpr(n)||e.SQHierarchyExprUtils.getSourceHierarchy(n),u=_.last(r);if(u&&u.children&&e.SQExpr.equals(u.expr,o)){var s=e.SQHierarchyExprUtils.expandExpr(t,n.arg);if(s instanceof Array){var c=s;a=!e.SQHierarchyExprUtils.areHierarchyLevelsOrdered(c,_.last(u.children),n)}}a?r.push({expr:o,children:[n],selectQueryIndex:i}):u.children.push(n)}t.groupExprs=r}(t=e.SQExprGroupUtils||(e.SQExprGroupUtils={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function r(e){return e.integer||e.numeric?t.QueryAggregateFunction.Sum:t.QueryAggregateFunction.Count}function n(e){switch(e){case 6:return t.QueryAggregateFunction.Avg;case 3:return t.QueryAggregateFunction.CountNonNull;case 7:return t.QueryAggregateFunction.Count;case 5:return t.QueryAggregateFunction.Max;case 4:return t.QueryAggregateFunction.Min;case 2:return t.QueryAggregateFunction.Sum;default:return}}var i=jsCommon.StringExtensions,a=function(){function i(e){this._kind=e}return i.equals=function(e,t,r){return A.run(e,t,r)},i.prototype.validate=function(e,t){var r=new O(e,t);return this.accept(r),r.errors},i.prototype.accept=function(e,t){},Object.defineProperty(i.prototype,"kind",{get:function(){return this._kind},enumerable:!0,configurable:!0}),i.prototype.getMetadata=function(e){var r=t.SQExprConverter.asFieldPattern(this);if(r)return r.column||r.columnAggr||r.measure?this.getMetadataForProperty(r,e):r.hierarchyLevel||r.hierarchyLevelAggr?this.getMetadataForHierarchyLevel(r,e):r.columnHierarchyLevelVariation?this.getMetadataForVariation(r,e):i.getMetadataForEntity(r,e)},i.prototype.getDefaultAggregate=function(e,i){void 0===i&&(i=!1);var a=this.getConceptualProperty(e)||this.getHierarchyLevelConceptualProperty(e);if(a){var o;if(a&&0===a.kind){var u=a.column?a.column.defaultAggregate:null;(a.type.integer||a.type.numeric)&&1!==u&&(o=n(u),void 0===o&&(o=r(a.type))),void 0===o&&i&&(o=t.QueryAggregateFunction.CountNonNull);
}return o}},i.prototype.getKeyColumns=function(e){var t=j.getColumnRefSQExpr(e,this);if(t){var r=[],n=this.getPropertyKeys(e);if(n&&n.length>0)for(var i=0,a=n.length;a>i;i++)r.push(Q.columnRef(t.source,n[i].name));else r.push(t);return r}},i.prototype.hasGroupOnKeys=function(e){var t=j.getColumnRefSQExpr(e,this);if(t){var r=this.getPropertyKeys(e);if(!r||r.length<1)return!1;if(r.length>1)return!0;var n=Q.columnRef(t.source,r[0].name);return!i.equals(n,this)}},i.prototype.getPropertyKeys=function(e){var t=this.getConceptualProperty(e)||this.getHierarchyLevelConceptualProperty(e);if(t)return t.column?t.column.keys:void 0},i.prototype.getConceptualProperty=function(e){var r=t.SQExprConverter.asFieldPattern(this);if(r){var n=t.FieldExprPattern.toFieldExprEntityItemPattern(r),i=t.FieldExprPattern.getPropertyName(r);return i?e.schema(n.schema).findProperty(n.entity,i):void 0}},i.prototype.getTargetEntityForVariation=function(e,t){var r=this.getConceptualProperty(e);if(r&&r.column&&!_.isEmpty(r.column.variations))for(var n=r.column.variations,i=0;i<n.length;i++){var a=n[i];if(a.name===t)return a.navigationProperty.targetEntity.name}},i.prototype.getHierarchyLevelConceptualProperty=function(e){var r=t.SQExprConverter.asFieldPattern(this);if(r){var n=r.hierarchyLevel||r.hierarchyLevelAggr;if(n){var i=t.FieldExprPattern.toFieldExprEntityItemPattern(r),a=e.schema(i.schema).findHierarchy(i.entity,n.name);if(a){var o=a.levels.withName(n.level);if(o)return o.column}}}},i.prototype.getMetadataForVariation=function(e,r){var n=e.columnHierarchyLevelVariation,i=t.FieldExprPattern.toFieldExprEntityItemPattern(e),a=r.schema(i.schema).findProperty(i.entity,n.source.name);if(a&&a.column&&a.column.variations)for(var o=0,u=a.column.variations;o<u.length;o++){var s=u[o];if(s.defaultHierarchy&&s.defaultHierarchy.levels)for(var c=0,l=s.defaultHierarchy.levels;c<l.length;c++){var p=l[c];if(p.name===n.level.level){var f=p.column;return{kind:1===f.kind?1:0,type:f.type,format:f.format,idOnEntityKey:f.column?f.column.idOnEntityKey:!1,defaultAggregate:f.column?f.column.defaultAggregate:null}}}}},i.prototype.getMetadataForHierarchyLevel=function(e,t){var r=this.getHierarchyLevelConceptualProperty(t);if(r)return this.getPropertyMetadata(e,r)},i.prototype.getPropertyMetadata=function(r,n){var i=n.format,a=n.type,o=r.columnAggr||r.hierarchyLevelAggr;if(o)switch(o.aggregate){case t.QueryAggregateFunction.Count:case t.QueryAggregateFunction.CountNonNull:a=e.ValueType.fromExtendedType(e.ExtendedType.Integer),i=void 0;break;case t.QueryAggregateFunction.Avg:a.integer&&(a=e.ValueType.fromExtendedType(e.ExtendedType.Double))}return{kind:1===n.kind||o&&void 0!==o.aggregate?1:0,type:a,format:i,idOnEntityKey:n.column?n.column.idOnEntityKey:!1,aggregate:o?o.aggregate:void 0,defaultAggregate:n.column?n.column.defaultAggregate:null}},i.prototype.getMetadataForProperty=function(e,t){var r=this.getConceptualProperty(t);if(r)return this.getPropertyMetadata(e,r)},i.getMetadataForEntity=function(r,n){var i=t.FieldExprPattern.toFieldExprEntityItemPattern(r),a=n.schema(i.schema).entities.withName(i.entity);if(a&&r.entityAggr)switch(r.entityAggr.aggregate){case t.QueryAggregateFunction.Count:case t.QueryAggregateFunction.CountNonNull:return{kind:1,type:e.ValueType.fromExtendedType(e.ExtendedType.Integer),format:void 0,idOnEntityKey:!1,aggregate:r.entityAggr.aggregate}}},i}();t.SQExpr=a,t.defaultAggregateForDataType=r,t.defaultAggregateToQueryAggregateFunction=n;var o=function(e){function t(t,r,n){e.call(this,0),this.schema=t,this.entity=r,n&&(this.variable=n)}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitEntity(this,t)},t}(a);t.SQEntityExpr=o;var u=function(e){function t(t,r,n){e.call(this,t),this.source=r,this.ref=n}return __extends(t,e),t}(a);t.SQPropRefExpr=u;var s=function(e){function t(t,r){e.call(this,1,t,r)}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitColumnRef(this,t)},t}(u);t.SQColumnRefExpr=s;var c=function(e){function t(t,r){e.call(this,2,t,r)}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitMeasureRef(this,t)},t}(u);t.SQMeasureRefExpr=c;var l=function(e){function t(t,r){e.call(this,3),this.arg=t,this.func=r}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitAggr(this,t)},t}(a);t.SQAggregationExpr=l;var p=function(e){function t(t,r,n){e.call(this,4),this.arg=t,this.name=r,this.property=n}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitPropertyVariationSource(this,t)},t}(a);t.SQPropertyVariationSourceExpr=p;var f=function(e){function t(t,r){e.call(this,5),this.arg=t,this.hierarchy=r}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitHierarchy(this,t)},t}(a);t.SQHierarchyExpr=f;var v=function(e){function t(t,r){e.call(this,6),this.arg=t,this.level=r}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitHierarchyLevel(this,t)},t}(a);t.SQHierarchyLevelExpr=v;var h=function(e){function t(t,r){e.call(this,7),this.left=t,this.right=r}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitAnd(this,t)},t}(a);t.SQAndExpr=h;var y=function(e){function t(t,r,n){e.call(this,8),this.arg=t,this.lower=r,this.upper=n}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitBetween(this,t)},t}(a);t.SQBetweenExpr=y;var d=function(e){function t(t,r){e.call(this,9),this.args=t,this.values=r}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitIn(this,t)},t}(a);t.SQInExpr=d;var g=function(e){function t(t,r){e.call(this,10),this.left=t,this.right=r}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitOr(this,t)},t}(a);t.SQOrExpr=g;var m=function(e){function t(t,r,n){e.call(this,12),this.comparison=t,this.left=r,this.right=n}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitCompare(this,t)},t}(a);t.SQCompareExpr=m;var x=function(e){function t(t,r){e.call(this,11),this.left=t,this.right=r}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitContains(this,t)},t}(a);t.SQContainsExpr=x;var b=function(e){function t(t,r){e.call(this,13),this.left=t,this.right=r}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitStartsWith(this,t)},t}(a);t.SQStartsWithExpr=b;var w=function(e){function t(t){e.call(this,14),this.arg=t}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitExists(this,t)},t}(a);t.SQExistsExpr=w;var E=function(e){function t(t){e.call(this,15),this.arg=t}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitNot(this,t)},t}(a);t.SQNotExpr=E;var S=function(e){function t(t,r,n){e.call(this,16),this.type=t,this.value=r,this.valueEncoded=n}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitConstant(this,t)},t.prototype.getMetadata=function(e){return{kind:1,type:this.type}},t}(a);t.SQConstantExpr=S;var C=function(e){function t(t,r){e.call(this,17),this.unit=t,this.arg=r}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitDateSpan(this,t)},t}(a);t.SQDateSpanExpr=C;var D=function(e){function t(t,r,n){e.call(this,18),this.unit=t,this.arg=n,this.amount=r}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitDateAdd(this,t)},t}(a);t.SQDateAddExpr=D;var V=function(e){function t(){e.call(this,19)}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitNow(this,t)},t}(a);t.SQNowExpr=V;var T=function(e){function t(){e.call(this,21)}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitDefaultValue(this,t)},t}(a);t.SQDefaultValueExpr=T;var P=function(e){function t(){e.call(this,20)}return __extends(t,e),t.prototype.accept=function(e,t){return e.visitAnyValue(this,t)},t}(a);t.SQAnyValueExpr=P;var Q;!function(r){function n(e,t,r){return new o(e,t,r)}function i(e,t){return new s(e,t)}function u(e,t){return new c(e,t)}function Q(e,t){return new l(e,t)}function F(e,t){return new f(e,t)}function A(e,t,r){return new p(e,t,r)}function N(e,t){return new v(e,t)}function O(e,t){return e?t?new h(e,t):e:t}function R(e,t,r){return new y(e,t,r)}function j(e,t){return new d(e,t)}function k(e,t){if(!e)return t;if(!t)return e;if(e instanceof d&&t instanceof d){var r=H(e,t);if(r)return r}return new g(e,t)}function H(e,t){if(e.args&&t.args){var n=e.args.length,i=t.args.length;if(n===i){for(var o=0;n>o;++o)if(!a.equals(e.args[o],t.args[o]))return;var u=e.values.concat(t.values);return r.inExpr(e.args,u)}}}function q(e,t,r){return new m(e,t,r)}function B(e,t){return new x(e,t)}function U(e){return new w(e)}function W(e,r){return q(t.QueryComparisonKind.Equal,e,r)}function G(e){return new E(e)}function z(e,t){return new b(e,t)}function K(){return new S(e.ValueType.fromExtendedType(e.ExtendedType.Null),null,t.PrimitiveValueEncoding.nullEncoding())}function Y(){return new V}function $(){return new T}function J(){return new P}function Z(r){return new S(e.ValueType.fromExtendedType(e.ExtendedType.Boolean),r,t.PrimitiveValueEncoding["boolean"](r))}function X(e,t,r){return new D(e,t,r)}function ee(r,n){return void 0===n&&(n=t.PrimitiveValueEncoding.dateTime(r)),new S(e.ValueType.fromExtendedType(e.ExtendedType.DateTime),r,n)}function te(e,t){return new C(e,t)}function re(r,n){return void 0===n&&(n=t.PrimitiveValueEncoding.decimal(r)),new S(e.ValueType.fromExtendedType(e.ExtendedType.Decimal),r,n)}function ne(r,n){return void 0===n&&(n=t.PrimitiveValueEncoding["double"](r)),new S(e.ValueType.fromExtendedType(e.ExtendedType.Double),r,n)}function ie(r,n){return void 0===n&&(n=t.PrimitiveValueEncoding.integer(r)),new S(e.ValueType.fromExtendedType(e.ExtendedType.Integer),r,n)}function ae(r,n){return new S(e.ValueType.fromExtendedType(e.ExtendedType.Text),r,n||t.PrimitiveValueEncoding.text(r))}function oe(t,r){return null==t?K():_.isBoolean(t)?Z(t):_.isString(t)?ae(t):_.isNumber(t)?r.integer&&e.Double.isInteger(t)?ie(t):ne(t):t instanceof Date?ee(t):void 0}function ue(e,t){return I.rewrite(e,t)}function se(e){return M.rewrite(e)}function ce(e){return L.rewrite(e)}function le(e,n,i,a){var o;return o=null!=a&&t.SQExprUtils.isSupportedAggregate(e,n,a)?a:e.getDefaultAggregate(n,i),void 0!==o&&(e=r.aggregate(e,o)),e}r.entity=n,r.columnRef=i,r.measureRef=u,r.aggregate=Q,r.hierarchy=F,r.propertyVariationSource=A,r.hierarchyLevel=N,r.and=O,r.between=R,r.inExpr=j,r.or=k,r.compare=q,r.contains=B,r.exists=U,r.equal=W,r.not=G,r.startsWith=z,r.nullConstant=K,r.now=Y,r.defaultValue=$,r.anyValue=J,r["boolean"]=Z,r.dateAdd=X,r.dateTime=ee,r.dateSpan=te,r.decimal=re,r["double"]=ne,r.integer=ie,r.text=ae,r.typedConstant=oe,r.setAggregate=ue,r.removeAggregate=se,r.removeEntityVariables=ce,r.createExprWithAggregate=le}(Q=t.SQExprBuilder||(t.SQExprBuilder={}));var F;!function(e){function t(e){return R.getAggregate(e)}e.getAggregate=t}(F=t.SQExprInfo||(t.SQExprInfo={}));var A=function(){function e(e){this.ignoreCase=e}return e.run=function(t,r,n){return t=t||null,r=r||null,t===r?!0:!t!=!r?!1:n?t.accept(e.ignoreCaseInstance,r):t.accept(e.instance,r)},e.prototype.visitColumnRef=function(e,t){return t instanceof s&&e.ref===t.ref&&this.equals(e.source,t.source)},e.prototype.visitMeasureRef=function(e,t){return t instanceof c&&e.ref===t.ref&&this.equals(e.source,t.source)},e.prototype.visitAggr=function(e,t){return t instanceof l&&e.func===t.func&&this.equals(e.arg,t.arg)},e.prototype.visitHierarchy=function(e,t){return t instanceof f&&e.hierarchy===t.hierarchy&&this.equals(e.arg,t.arg)},e.prototype.visitHierarchyLevel=function(e,t){return t instanceof v&&e.level===t.level&&this.equals(e.arg,t.arg)},e.prototype.visitPropertyVariationSource=function(e,t){return t instanceof p&&e.name===t.name&&e.property===t.property&&this.equals(e.arg,t.arg)},e.prototype.visitBetween=function(e,t){return t instanceof y&&this.equals(e.arg,t.arg)&&this.equals(e.lower,t.lower)&&this.equals(e.upper,t.upper)},e.prototype.visitIn=function(e,t){if(!(t instanceof d&&this.equalsAll(e.args,t.args)))return!1;var r=e.values,n=t.values;if(r.length!==n.length)return!1;for(var i=0,a=r.length;a>i;i++)if(!this.equalsAll(r[i],n[i]))return!1;return!0},e.prototype.visitEntity=function(e,t){return t instanceof o&&e.schema===t.schema&&e.entity===t.entity&&this.optionalEqual(e.variable,t.variable)},e.prototype.visitAnd=function(e,t){return t instanceof h&&this.equals(e.left,t.left)&&this.equals(e.right,t.right)},e.prototype.visitOr=function(e,t){return t instanceof g&&this.equals(e.left,t.left)&&this.equals(e.right,t.right)},e.prototype.visitCompare=function(e,t){return t instanceof m&&e.comparison===t.comparison&&this.equals(e.left,t.left)&&this.equals(e.right,t.right)},e.prototype.visitContains=function(e,t){return t instanceof x&&this.equals(e.left,t.left)&&this.equals(e.right,t.right)},e.prototype.visitDateSpan=function(e,t){return t instanceof C&&e.unit===t.unit&&this.equals(e.arg,t.arg)},e.prototype.visitDateAdd=function(e,t){return t instanceof D&&e.unit===t.unit&&e.amount===t.amount&&this.equals(e.arg,t.arg)},e.prototype.visitExists=function(e,t){return t instanceof w&&this.equals(e.arg,t.arg)},e.prototype.visitNot=function(e,t){return t instanceof E&&this.equals(e.arg,t.arg)},e.prototype.visitNow=function(e,t){return t instanceof V},e.prototype.visitDefaultValue=function(e,t){return t instanceof T},e.prototype.visitAnyValue=function(e,t){return t instanceof P},e.prototype.visitStartsWith=function(e,t){return t instanceof b&&this.equals(e.left,t.left)&&this.equals(e.right,t.right)},e.prototype.visitConstant=function(e,t){return t instanceof S&&e.type===t.type?e.type.text&&this.ignoreCase?i.equalIgnoreCase(e.valueEncoded,t.valueEncoded):e.valueEncoded===t.valueEncoded:!1},e.prototype.optionalEqual=function(e,t){return e&&t?e===t:!0},e.prototype.equals=function(e,t){return e.accept(this,t)},e.prototype.equalsAll=function(e,t){var r=e.length;if(r!==t.length)return!1;for(var n=0;r>n;n++)if(!this.equals(e[n],t[n]))return!1;return!0},e.instance=new e(!1),e.ignoreCaseInstance=new e(!0),e}(),N=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.visitDefault=function(e){return e},t}(t.DefaultSQExprVisitor),O=function(e){function r(t,r){e.call(this),this.schema=t,r&&(this.errors=r)}return __extends(r,e),r.prototype.visitIn=function(t){for(var r=e.prototype.visitIn.call(this,t),n=r.args,i=r.values,a=0;a<i.length;a++)for(var o=i[a],u=0,s=o.length;s>u;++u)this.validateCompatibleType(n[u],o[u]);return r},r.prototype.visitCompare=function(t){var r=e.prototype.visitCompare.call(this,t);return this.validateCompatibleType(r.left,r.right),r},r.prototype.visitColumnRef=function(e){var r=t.SQExprConverter.asFieldPattern(e);if(r){var n=t.FieldExprPattern.toFieldExprEntityItemPattern(r),i=this.validateEntity(n.schema,n.entity);if(i){var a=i.properties.withName(r.column.name);a&&0===a.kind&&this.isQueryable(r)||this.register(3)}}return e},r.prototype.visitMeasureRef=function(e){var r=t.SQExprConverter.asFieldPattern(e);if(r){var n=t.FieldExprPattern.toFieldExprEntityItemPattern(r),i=this.validateEntity(n.schema,n.entity);if(i){var a=i.properties.withName(r.measure.name);a&&1===a.kind&&this.isQueryable(r)||this.register(4)}}return e},r.prototype.visitAggr=function(r){var n=e.prototype.visitAggr.call(this,r),i=j.getColumnRefSQExpr(this.schema,n.arg);if(i){var a=t.SQExprUtils.getSupportedAggregates(i,this.schema);a.indexOf(r.func)<0&&this.register(0)}return n},r.prototype.visitHierarchy=function(e){var r=t.SQExprConverter.asFieldPattern(e);if(r){var n=r.hierarchy;n?this.validateHierarchy(n.schema,n.entity,n.name):this.register(5)}return e},r.prototype.visitHierarchyLevel=function(e){var r=t.SQExprConverter.asFieldPattern(e);if(r){var n=r.hierarchyLevel;n?this.validateHierarchyLevel(n.schema,n.entity,n.name,n.level):r.columnHierarchyLevelVariation||this.register(6)}return e},r.prototype.visitEntity=function(e){return this.validateEntity(e.schema,e.entity),e},r.prototype.visitContains=function(e){return this.validateOperandsAndTypeForStartOrContains(e.left,e.right),e},r.prototype.visitStartsWith=function(e){return this.validateOperandsAndTypeForStartOrContains(e.left,e.right),e},r.prototype.validateOperandsAndTypeForStartOrContains=function(e,t){e instanceof s?this.visitColumnRef(e):e instanceof v?this.visitHierarchyLevel(e):this.register(7),t instanceof S&&t.type.text?this.validateCompatibleType(e,t):this.register(8)},r.prototype.validateCompatibleType=function(e,t){var r=e.getMetadata(this.schema),n=r&&r.type,i=t.getMetadata(this.schema),a=i&&i.type;n&&a&&!n.isCompatibleFrom(a)&&this.register(9)},r.prototype.validateEntity=function(e,t){var r=this.schema.schema(e);if(r){var n=r.entities.withName(t);if(n)return n;this.register(2)}else this.register(1)},r.prototype.validateHierarchy=function(e,t,r){var n=this.validateEntity(e,t);if(n){var i=n.hierarchies.withName(r);if(i)return i;this.register(5)}},r.prototype.validateHierarchyLevel=function(e,t,r,n){var i=this.validateHierarchy(e,t,r);if(i){var a=i.levels.withName(n);if(a)return a;this.register(6)}},r.prototype.register=function(e){this.errors||(this.errors=[]),this.errors.push(e)},r.prototype.isQueryable=function(e){var r=t.FieldExprPattern.toFieldExprEntityItemPattern(e);if(e.hierarchyLevel||e.hierarchyLevelAggr){var n=t.SQHierarchyExprUtils.getConceptualHierarchyLevelFromExpr(this.schema,e);return n&&1!==n.column.queryable}return 1!==this.schema.schema(r.schema).findProperty(r.entity,t.FieldExprPattern.getPropertyName(e)).queryable},r}(t.SQExprRewriter);t.SQExprValidationVisitor=O;var R=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.visitAggr=function(e){return e.func},t.prototype.visitDefault=function(e){},t.getAggregate=function(e){var r=new t;return e.accept(r)},t}(t.DefaultSQExprVisitor),j=function(e){function r(t){e.call(this),this.schema=t}return __extends(r,e),r.prototype.visitColumnRef=function(e){return e},r.prototype.visitHierarchyLevel=function(e){var r=e.level,n=e.arg,i=n.accept(this);if(n&&n.arg instanceof p){var a=n.arg,o=i.getTargetEntityForVariation(this.schema,a.name);if(i&&o){var u=i.source.schema,c=Q.entity(u,o),l=this.schema.schema(u).findHierarchy(o,n.hierarchy);if(l)for(var f=0,v=l.levels;f<v.length;f++){var h=v[f];if(h.name===r)return new s(c,h.column.name)}}}else{var y=n.arg,d=t.SQHierarchyExprUtils.getConceptualHierarchyLevel(this.schema,y.schema,y.entity,n.hierarchy,e.level);if(d)return new s(n.arg,d.column.name)}},r.prototype.visitHierarchy=function(e){return e.arg.accept(this)},r.prototype.visitPropertyVariationSource=function(e){var t=e.property;return new s(e.arg,t)},r.prototype.visitDefault=function(e){},r.getColumnRefSQExpr=function(e,t){var n=new r(e);return t.accept(n)},r}(t.DefaultSQExprVisitor),I=function(e){function t(t){e.call(this),this.func=t}return __extends(t,e),t.prototype.visitAggr=function(e){return e.func===this.func?e:new l(e.arg,this.func)},t.prototype.visitColumnRef=function(e){return new l(e,this.func)},t.rewrite=function(e,r){var n=new t(r);return e.accept(n)},t}(N),M=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.visitAggr=function(e){return e.arg},t.rewrite=function(e){return e.accept(t.instance)},t.instance=new t,t}(N),L=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.visitEntity=function(e){return e.variable?Q.entity(e.schema,e.entity):e},t.rewrite=function(e){return e.accept(t.instance)},t.instance=new t,t}(t.SQExprRewriter)}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t,r=jsCommon.StringExtensions;!function(t){function n(t,r){var n=[],i=g(t,r);if(!i)return n;var a=i.type,o=i.kind,u=i.idOnEntityKey,s=e.QueryAggregateFunction;if(!a)return n;if(1===o)return n;if(a.numeric||a.integer){var c=[s.Sum,s.Avg,s.Min,s.Max,s.Count,s.CountNonNull,s.StandardDeviation,s.Variance],l=e.SQExprConverter.asFieldPattern(t),p=e.FieldExprPattern.toFieldExprEntityItemPattern(l),f=r.schema(p.schema);return f.capabilities.supportsMedian&&c.push(s.Median),c}return a.text||a.bool||a.dateTime?u?[s.CountNonNull]:[s.Count,s.CountNonNull]:n}function i(e,t,r){var i=n(e,t);return _.contains(i,r)}function a(t,r){for(var n=0,i=t.length;i>n;n++)if(e.SQExpr.equals(t[n],r))return n;return-1}function o(t,r){var n=t.length;if(n!==r.length)return!1;for(var i=0;n>i;i++)if(!e.SQExpr.equals(t[i],r[i]))return!1;return!0}function u(e,t){for(var n={},i=0,a=e.length;a>i;i++)n[e[i].name]=!0;return r.findUniqueName(n,s(t))}function s(e,t){return void 0===t&&(t="select"),e?e.accept(E.instance,t):t}function c(e){return e.accept(S.instance)}function l(e){return e.accept(D.instance)}function p(e){return e.accept(C.instance)}function f(e,t){var r=v(e,t);return r&&r.discourageQueryAggregateUsage}function v(t,r){var n=e.SQExprConverter.asFieldPattern(t);if(n){var i=e.FieldExprPattern.toFieldExprEntityItemPattern(n),a=r.schema(i.schema);return a?a.capabilities:void 0}}function h(t,r){var n=d(t,r);if(n){var i=e.SQExprConverter.asFieldPattern(t).measure;if(i)return e.SQExprBuilder.fieldExpr({measure:{schema:i.schema,entity:i.entity,name:n.name}})}}function y(e,t){var r=e.getConceptualProperty(t);if(r){if(r.measure&&r.measure.kpi)return r.measure.kpi.statusMetadata;var n=d(e,t);return n?n.kpi.measure.kpi.statusMetadata:void 0}}function d(e,t){var r=e.getConceptualProperty(t);if(r){var n=r.kpi;return n&&n.measure.kpi.status===r?r:void 0}}function g(t,r){var n=e.SQExprBuilder.removeAggregate(t).getMetadata(r);return n||(n=t.getMetadata(r)),n}function m(t,r){if(t&&r){var n=e.SQExprConverter.asFieldPattern(t);if(n){var i=n.column;if(i){if(r.schema(i.schema)&&n.column.name){var a=r.schema(i.schema).findProperty(i.entity,n.column.name);if(a&&a.column)return a.column.defaultValue}}else{var o=n.hierarchyLevel;if(o){var u=e.FieldExprPattern.toFieldExprEntityItemPattern(n),s=u.schema;if(r.schema(s)){var c=r.schema(s).findHierarchy(u.entity,o.name);if(c){var l=c.levels.withName(o.level);if(l&&l.column&&l.column.column)return l.column.column.defaultValue}}}}}}}function x(e,t){if(!_.isEmpty(e)&&t){for(var r=[],n=0;n<e.length;n++){var i=e[n],a=m(i,t);a&&r.push(a)}return r}}function b(t,r){for(var n=[],i=0;i<t.length;i++)n.push(e.SQExprBuilder.compare(e.QueryComparisonKind.Equal,t[i],r[i]));if(!_.isEmpty(n)){for(var a,o=0;o<n.length;o++){var u=n[o];a=e.SQExprBuilder.and(a,u)}return a}}function w(e){var t=[];if(e){var r=e.from();if(void 0!==r)for(var n=0,i=r.keys();n<i.length;n++){var a=i[n],o=r.entity(a);t.indexOf(o.entity)<0&&t.push(o.entity)}}return t}t.getSupportedAggregates=n,t.isSupportedAggregate=i,t.indexOfExpr=a,t.sequenceEqual=o,t.uniqueName=u,t.defaultName=s,t.isMeasure=c,t.isAnyValue=l,t.isDefaultValue=p,t.discourageAggregation=f,t.getSchemaCapabilities=v,t.getKpiStatus=h,t.getKpiMetadata=y,t.getDefaultValue=m,t.getDefaultValues=x,t.getDataViewScopeIdentityComparisonExpr=b,t.getActiveTablesNames=w;var E=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype.visitEntity=function(e){return e.entity},r.prototype.visitColumnRef=function(e){return e.source.accept(this)+"."+e.ref},r.prototype.visitMeasureRef=function(e,t){return e.source.accept(this)+"."+e.ref},r.prototype.visitAggr=function(t,r){return e.QueryAggregateFunction[t.func]+"("+t.arg.accept(this)+")"},r.prototype.visitConstant=function(e){return"const"},r.prototype.visitDefault=function(e,t){return t||"expr"},r.instance=new r,r}(e.DefaultSQExprVisitorWithArg),S=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.visitMeasureRef=function(e){return!0},t.prototype.visitAggr=function(e){return!0},t.prototype.visitDefault=function(e){return!1},t.instance=new t,t}(e.DefaultSQExprVisitor),C=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype.visitCompare=function(t){return t.comparison!==e.QueryComparisonKind.Equal?!1:t.right.accept(this)},r.prototype.visitAnd=function(e){return e.left.accept(this)&&e.right.accept(this)},r.prototype.visitDefaultValue=function(e){return!0},r.prototype.visitDefault=function(e){return!1},r.instance=new r,r}(e.DefaultSQExprVisitor),D=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype.visitCompare=function(t){return t.comparison!==e.QueryComparisonKind.Equal?!1:t.right.accept(this)},r.prototype.visitAnd=function(e){return e.left.accept(this)&&e.right.accept(this)},r.prototype.visitAnyValue=function(e){return!0},r.prototype.visitDefault=function(e){return!1},r.instance=new r,r}(e.DefaultSQExprVisitor)}(t=e.SQExprUtils||(e.SQExprUtils={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function t(e){this.exprRewriter=e}return t.prototype.rewriteFrom=function(t){for(var r={},n=t,i=n.keys(),a=0,o=i.length;o>a;a++){var u=i[a],s=n.entity(u),c=e.SQExprBuilder.entity(s.schema,s.entity,u),l=c.accept(this.exprRewriter);r[u]={schema:l.schema,entity:l.entity}}return new e.SQFrom(r)},t.prototype.rewriteSelect=function(t,r){for(var n=[],i=0,a=t.length;a>i;i++){var o=t[i];n.push({name:o.name,expr:e.SQExprRewriterWithSourceRenames.rewrite(o.expr.accept(this.exprRewriter),r)})}return n},t.prototype.rewriteOrderBy=function(t,r){if(!_.isEmpty(t)){for(var n=[],i=0,a=t.length;a>i;i++){var o=t[i],u=e.SQExprRewriterWithSourceRenames.rewrite(o.expr.accept(this.exprRewriter),r);n.push({direction:o.direction,expr:u})}return n}},t.prototype.rewriteWhere=function(t,r){var n=this;if(!_.isEmpty(t)){for(var i=[],a=0,o=t.length;o>a;a++){var u=t[a],s={condition:e.SQExprRewriterWithSourceRenames.rewrite(u.condition.accept(this.exprRewriter),r)};u.target&&(s.target=_.map(u.target,function(t){return e.SQExprRewriterWithSourceRenames.rewrite(t.accept(n.exprRewriter),r)})),i.push(s)}return i}},t}();e.SemanticQueryRewriter=t}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=jsCommon.ArrayExtensions,r=function(){function r(e,t,r,n){this.fromValue=e,this.whereItems=t,this.orderByItems=r,this.selectItems=n}return r.create=function(){return r.empty||(r.empty=new r(new i,null,null,[])),r.empty},r.createWithTrimmedFrom=function(e,t,n,i){var a=new u(e.keys());if(t)for(var o=0,s=t.length;s>o;o++){var c=t[o];c.condition.accept(a);var l=c.target;if(l)for(var p=0,f=l.length;f>p;p++)l[p]&&l[p].accept(a)}if(n)for(var o=0,s=n.length;s>o;o++)n[o].expr.accept(a);for(var o=0,s=i.length;s>o;o++)i[o].expr.accept(a);for(var v=a.result(),o=0,s=v.length;s>o;o++)e.remove(v[o]);return new r(e,t,n,i)},r.prototype.from=function(){return this.fromValue.clone()},r.prototype.select=function(e){return 0===arguments.length?this.getSelect():this.setSelect(e)},r.prototype.getSelect=function(){return t.extendWithName(_.map(this.selectItems,function(e){return{name:e.name,expr:e.expr}}))},r.prototype.setSelect=function(e){for(var t=[],n=this.fromValue.clone(),i=0,o=e.length;o>i;i++){var u=e[i];t.push({name:u.name,expr:a.rewrite(u.expr,n)})}return r.createWithTrimmedFrom(n,this.whereItems,this.orderByItems,t)},r.prototype.removeSelect=function(t){for(var n=this.selectItems,i=[],a=0,o=n.length;o>a;a++){var u=n[a];e.SQExpr.equals(u.expr,t)||i.push(u)}return r.createWithTrimmedFrom(this.fromValue.clone(),this.whereItems,this.orderByItems,i)},r.prototype.removeOrderBy=function(t){for(var n=this.orderBy(),i=n.length-1;i>=0;i--)e.SQExpr.equals(n[i].expr,t)&&n.splice(i,1);return r.createWithTrimmedFrom(this.fromValue.clone(),this.whereItems,n,this.selectItems)},r.prototype.selectNameOf=function(t){var r=e.SQExprUtils.indexOfExpr(_.map(this.selectItems,function(e){return e.expr}),t);return r>=0?this.selectItems[r].name:void 0},r.prototype.setSelectAt=function(e,t){if(!(e>=this.selectItems.length)){var n=this.select(),i=this.fromValue.clone(),o=n[e].name;return n[e]={name:o,expr:a.rewrite(t,i)},r.createWithTrimmedFrom(i,this.whereItems,this.orderByItems,n)}},r.prototype.addSelect=function(t){var n=this.select(),i=this.fromValue.clone();return n.push({name:e.SQExprUtils.uniqueName(n,t),expr:a.rewrite(t,i)}),r.createWithTrimmedFrom(i,this.whereItems,this.orderByItems,n)},r.prototype.orderBy=function(e){return 0===arguments.length?this.getOrderBy():this.setOrderBy(e)},r.prototype.getOrderBy=function(){var e=[],t=this.orderByItems;if(t)for(var r=0,n=t.length;n>r;r++){var i=t[r];e.push({expr:i.expr,direction:i.direction})}return e},r.prototype.setOrderBy=function(e){for(var t=[],n=this.fromValue.clone(),i=0,o=e.length;o>i;i++){var u=e[i];t.push({expr:a.rewrite(u.expr,n),direction:u.direction})}return r.createWithTrimmedFrom(n,this.whereItems,t,this.selectItems)},r.prototype.where=function(e){return 0===arguments.length?this.getWhere():this.setWhere(e)},r.prototype.getWhere=function(){var e=[],t=this.whereItems;if(t)for(var r=0,n=t.length;n>r;r++)e.push(t[r]);return e},r.prototype.setWhere=function(e){for(var t=[],n=this.fromValue.clone(),i=0,o=e.length;o>i;i++){var u=e[i],s={condition:a.rewrite(u.condition,n)},c=u.target;if(c){s.target=[];for(var l=0,p=c.length;p>l;l++)if(c[l]){var f=a.rewrite(c[l],n);s.target.push(f)}}t.push(s)}return r.createWithTrimmedFrom(n,t,this.orderByItems,this.selectItems)},r.prototype.addWhere=function(e){for(var t=this.where(),n=e.where(),i=this.fromValue.clone(),o=0,u=n.length;u>o;o++){var s=n[o],c={condition:a.rewrite(s.condition,i)};s.target&&(c.target=_.map(s.target,function(e){return a.rewrite(e,i)})),t.push(c)}return r.createWithTrimmedFrom(i,t,this.orderByItems,this.selectItems)},r.prototype.rewrite=function(t){var n=new e.SemanticQueryRewriter(t),i=n.rewriteFrom(this.fromValue),a=n.rewriteWhere(this.whereItems,i),o=n.rewriteOrderBy(this.orderByItems,i),u=n.rewriteSelect(this.selectItems,i);return r.createWithTrimmedFrom(i,a,o,u)},r}();e.SemanticQuery=r;var n=function(){function r(e,t){this.fromValue=e,this.whereItems=t}return r.fromSQExpr=function(e){var t=new i,n=a.rewrite(e,t),o=[{condition:n}];return new r(t,o)},r.getDefaultValueFilter=function(t){return r.getDataViewScopeIdentityComparisonFilters(t,e.SQExprBuilder.defaultValue())},r.getAnyValueFilter=function(t){return r.getDataViewScopeIdentityComparisonFilters(t,e.SQExprBuilder.anyValue())},r.getDataViewScopeIdentityComparisonFilters=function(t,n){if(t instanceof Array){var i=Array.apply(null,Array(t.length)).map(function(){return n});return r.fromSQExpr(e.SQExprUtils.getDataViewScopeIdentityComparisonExpr(t,i))}return r.fromSQExpr(e.SQExprBuilder.equal(t,n))},r.prototype.from=function(){return this.fromValue.clone()},r.prototype.conditions=function(){for(var e=[],t=this.whereItems,r=0,n=t.length;n>r;r++){var i=t[r];e.push(i.condition)}return e},r.prototype.where=function(){for(var e=[],t=this.whereItems,r=0,n=t.length;n>r;r++)e.push(t[r]);return e},r.prototype.rewrite=function(t){var n=new e.SemanticQueryRewriter(t),i=n.rewriteFrom(this.fromValue),a=n.rewriteWhere(this.whereItems,i);return new r(i,a)},r.prototype.validate=function(t,r){var n=new e.SQExprValidationVisitor(t,r);return this.rewrite(n),n.errors},r.merge=function(e){if(_.isEmpty(e))return null;if(1===e.length)return e[0];for(var n=e[0],i=n.from(),a=t.take(n.whereItems,n.whereItems.length),o=1,u=e.length;u>o;o++)r.applyFilter(e[o],i,a);return new r(i,a)},r.isDefaultFilter=function(t){return t&&1===t.where().length?e.SQExprUtils.isDefaultValue(t.where()[0].condition):!1},r.isAnyFilter=function(t){return t&&1===t.where().length?e.SQExprUtils.isAnyValue(t.where()[0].condition):!1},r.isSameFilter=function(e,t){return jsCommon.JsonComparer.equals(e,t)?!(r.isDefaultFilter(e)&&r.isAnyFilter(t)||r.isAnyFilter(e)&&r.isDefaultFilter(t)):!1},r.applyFilter=function(e,t,r){for(var n=e.whereItems,i=0;i<n.length;i++){var o=n[i],u={condition:a.rewrite(o.condition,t)};o.target&&(u.target=_.map(o.target,function(e){return a.rewrite(e,t)})),r.push(u)}},r}();e.SemanticFilter=n;var i=function(){function e(e){this.items=e||{}}return e.prototype.keys=function(){return Object.keys(this.items)},e.prototype.entity=function(e){return this.items[e]},e.prototype.ensureEntity=function(e,t){for(var r=this.keys(),n=0,i=r.length;i>n;n++){var a=r[n],o=this.items[a];
if(o&&e.entity===o.entity&&e.schema===o.schema)return{name:a}}for(var u=t||this.candidateName(e.entity),s=u,c=2;this.items[s];)s=u+c++;return this.items[s]=e,{name:s,"new":!0}},e.prototype.remove=function(e){delete this.items[e]},e.prototype.candidateName=function(e){var t=e.lastIndexOf(".");return t>=0&&t!==e.length-1&&(e=e.substr(t+1)),e.substring(0,1).toLowerCase()},e.prototype.clone=function(){var t=new e;return $.extend(t.items,this.items),t},e}();e.SQFrom=i;var a=function(r){function n(e){r.call(this),this.renames=e}return __extends(n,r),n.prototype.visitEntity=function(t){var n=this.renames[t.entity];return n?new e.SQEntityExpr(t.schema,t.entity,n):r.prototype.visitEntity.call(this,t)},n.prototype.rewriteFilter=function(e){var t=void 0;e.target&&(t=this.rewriteArray(e.target));var r=e.condition.accept(this);if(e.condition===r&&e.target===t)return e;var n={condition:r};return t&&(n.target=t),n},n.prototype.rewriteArray=function(e){for(var r,n=0,i=e.length;i>n;n++){var a=e[n],o=a.accept(this);a===o||r||(r=t.take(e,n)),r&&r.push(o)}return r||e},n.rewrite=function(e,t){var r=o.run(e,t),i=new n(r);return e.accept(i)},n}(e.SQExprRewriter);e.SQExprRewriterWithSourceRenames=a;var o=function(e){function t(t){e.call(this),this.from=t,this.renames={}}return __extends(t,e),t.run=function(e,r){var n=new t(r);return e.accept(n),n.renames},t.prototype.visitEntity=function(e){var t=this.from.entity(e.variable);if(!t||t.schema!==e.schema||t.entity!==e.entity){var r=this.from.ensureEntity({schema:e.schema,entity:e.entity},e.variable);this.renames[e.entity]=r.name}},t}(e.DefaultSQExprVisitorWithTraversal),u=function(e){function t(t){e.call(this),this.keys=t}return __extends(t,e),t.prototype.visitEntity=function(e){var t=this.keys.indexOf(e.variable);t>=0&&this.keys.splice(t,1)},t.prototype.result=function(){return this.keys},t}(e.DefaultSQExprVisitorWithTraversal)}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function r(){return new s}function n(e,r,n,i){var a=e.identities;return a?a[r]:t.createDataViewScopeIdentity(u.equal(e.fields[0],u.typedConstant(n,i)))}function i(e,t){_.contains(e,t)||e.push(t)}function a(e,t,r){var n=t.values;e.values=n;var i=t.highlights;i&&(e.highlights=i),void 0!==t.minLocal&&(e.minLocal=t.minLocal),void 0!==t.maxLocal&&(e.maxLocal=t.maxLocal)}var o=e.data.DataViewTransform,u=e.data.SQExprBuilder;t.createCategoricalDataViewBuilder=r;var s=function(){function e(){this.categories=[],this.measureColumns=[],this.columnIndex=0}return e.prototype.withCategory=function(e){var t=e.values,r=e.identityFrom,i=e.source.type,a={source:e.source,identityFields:e.identityFrom.fields,identity:e.identityFrom.identities||[],values:t};if(!e.identityFrom.identities)for(var o=0,u=t.length;u>o;o++)a.identity.push(n(r,o,t[o],i));return this.categories||(this.categories=[]),this.categories.push(a),this},e.prototype.withCategories=function(e){return _.isEmpty(this.categories)?this.categories=e:Array.prototype.push.apply(this.categories,e),this},e.prototype.withValues=function(e){for(var t=e.columns,r=0;r<t.length;r++){var n=t[r];this.measureColumns.push(n.source)}return this.data=t,this},e.prototype.withGroupedValues=function(e){this.hasDynamicSeries=!0;var t=e.groupColumn;this.dynamicSeriesMetadata={column:t.source,identityFrom:t.identityFrom,values:t.values};for(var r=e.valueColumns,n=0;n<r.length;n++){var i=r[n];this.measureColumns.push(i.source)}return this.data=e.data,this},e.prototype.fillData=function(e,t){var r=_.first(this.categories),n=r&&r.values?r.values.length:1;if(this.hasDynamicSeries)for(var i=this.data,o=0;o<this.dynamicSeriesMetadata.values.length;o++)for(var u=i[o],s=0,c=this.measureColumns.length;c>s;s++){var l=o*c+s;a(e[l],u[s],n)}else for(var p=this.data,s=0,c=this.measureColumns.length;c>s;s++)a(e[s],p[s],n)},e.prototype.build=function(){for(var e,t=[],r={},a=this.categories,u=this.dynamicSeriesMetadata,s=0;s<a.length;s++){var c=a[s];i(t,c.source)}if(this.hasDynamicSeries&&i(t,u.column),this.hasDynamicSeries){r.values=o.createValueColumns([],u.identityFrom.fields,u.column);var l=this.measureColumns;e=[];for(var p=u.values,f=0;f<p.length;f++)for(var v=p[f],h=n(u.identityFrom,f,v,u.column.type),y=0;y<l.length;y++){var d=l[y],g=_.clone(d);g.groupName=v,e.push(g),i(t,g),r.values.push({source:g,values:[],identity:h})}}else{r.values=o.createValueColumns(),e=this.measureColumns;for(var m=0;m<e.length;m++){var d=e[m],g=d;i(t,g),r.values.push({source:g,values:[]})}}var x=this.categories;return _.isEmpty(x)||(r.categories=x),this.fillData(r.values,e),{metadata:{columns:t},categorical:r}},e}()}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function r(e,t){return new a(e||{metadata:{columns:[]}},t)}function n(e,t,r){var n=r.rows;if(!n||1===n.length)for(var a=r.columns,o=0,u=t.length;u>o;o++){var s=t[o];if(i.equals(s.expr,e)&&s.queryName)for(var c=0,l=a.length;l>c;c++)if(o===a[c].index)return n[0][c]}}var i=e.data.SQExpr;t.createStaticEvalContext=r;var a=function(){function e(e,t){this.dataView=e,this.selectTransforms=t}return e.prototype.getExprValue=function(e){var t=this.dataView,r=this.selectTransforms;return t&&t.table&&r?n(e,r,t.table):void 0},e.prototype.getCurrentIdentity=function(){},e.prototype.getRoleValue=function(e){},e}()}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){function t(t){return e.createStaticEvalContext()}e.createMatrixEvalContext=t}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t,r=jsCommon.StringExtensions,n=jsCommon.Formatting,i=jsCommon.RegExpExtensions;!function(e){function t(e,t){for(var n=t.length,i=0;n>i;i++){var a="\\"+t[i],o=String.fromCharCode(57344+i);e=r.replaceAll(e,a,o)}return e}function n(e,t){for(var n=t.length,i=0;n>i;i++){var a=String.fromCharCode(57344+i),o=t[i];e=r.replaceAll(e,a,o)}return r.replaceAll(e,"\\","")}function i(e,t){e=r.replaceAll(e,'"',"'");for(var n=0;;n++){var i=e.indexOf("'");if(0>i)break;var a=e.indexOf("'",i+1);if(0>a)break;var o=e.substring(i,a+1);t.push(o.substring(1,a-i));var u=String.fromCharCode(57600+n);e=e.replace(o,u)}return e}function a(e,t){for(var r=t.length,n=0;r>n;n++){var i=String.fromCharCode(57600+n),a=t[n];e=e.replace(i,a)}return e}e.preserveEscaped=t,e.restoreEscaped=n,e.preserveLiterals=i,e.restoreLiterals=a}(t||(t={}));var a,o=/({{)|(}})|{(\d+[^}]*)}/g,u="0",s="#",c="E",l=[u,s],p=new RegExp(l.join("|"),"g"),f=function(){function e(){}return e.prototype.formatValue=function(e,t,r){if(void 0===e||null===e)return"";var n=this.getCulture(r);return a.canFormat(e)?a.format(e,t,n):v.canFormat(e)?v.format(e,t,n):e.toString()},e.prototype.format=function(e,t,r){var n=this;if(!e)return"";var i=e.replace(o,function(e,i,a,o){if(i)return"{";if(a)return"}";var u=o.split(":"),s=parseInt(u[0],10),c=u[1];return n.formatValue(t[s],c,r)});return i},e.prototype.isStandardNumberFormat=function(e){return v.isStandardFormat(e)},e.prototype.formatNumberWithCustomOverride=function(e,t,r,n){var i=this.getCulture(n);return v.formatWithCustomOverride(e,t,r,i)},e.prototype.dateFormatString=function(e){return this._dateTimeScaleFormatInfo.getFormatString(e)},e.prototype.setCurrentCulture=function(e){this._currentCultureSelector!==e&&(this._currentCulture=this.getCulture(e),this._currentCultureSelector=e,this._dateTimeScaleFormatInfo=new h(this._currentCulture))},e.prototype.getCulture=function(e){if(null==e)return null==this._currentCulture&&this.initialize(),this._currentCulture;var t=Globalize.findClosestCulture(e);return t||(t=Globalize.culture("en-US")),t},e.prototype.initialize=function(){var e=this.getUrlParam("language")||window.cultureInfo||window.navigator.userLanguage||window.navigator.language||Globalize.culture().name;this.setCurrentCulture(e);var t=this.getUrlParam("calendar");if(t){var r=this._currentCulture,n=r.calendars[t];n&&(r.calendar=n)}},e.prototype.getUrlParam=function(e){var t=window.location.search.match(RegExp("[?&]"+e+"=([^&]*)"));return t?t[1]:void 0},e}();!function(e){function i(e){var t=e instanceof Date;return t}function a(e,t,r){t=t||"G";var n=1===t.length;try{return n?o(e,t,r):u(e,t,r)}catch(i){return o(e,"G",r)}}function o(e,t,r){var i=r.calendar.patterns;l(r.calendar);var a=n.findDateFormat(e,t,r.name);return t=1===a.format.length?i[a.format]:a.format,r=Globalize.culture("en-US"),Globalize.format(a.value,t,r)}function u(e,n,i){var a,o=[];if(n=t.preserveEscaped(n,"\\dfFghHKmstyz:/%'\""),n=t.preserveLiterals(n,o),n=r.replaceAll(n,'"',"'"),n.indexOf("F")>-1){n=r.replaceAll(n,"FFFF","FFF");var u=e.getMilliseconds();if(u%10>=1&&(n=r.replaceAll(n,"FFF","fff")),n=r.replaceAll(n,"FFF","FF"),u%100/10>=1&&(n=r.replaceAll(n,"FF","ff")),n=r.replaceAll(n,"FF","F"),u%1e3/100>=1&&(n=r.replaceAll(n,"F","f")),n=r.replaceAll(n,"F",""),""===n||"%"===n)return""}return n=s(n),a=Globalize.format(e,n,i),a=c(a,i.calendar),a=t.restoreLiterals(a,o),a=t.restoreEscaped(a,"\\dfFghHKmstyz:/%'\"")}function s(e){return e===p?f:(p=e,e=n.fixDateTimeFormat(e),f=e,e)}function c(e,t){var r=t[":"];if(":"===r)return e;for(var n="",i=e.length,a=0;i>a;a++){var o=e.charAt(a);switch(o){case":":n+=r;break;default:n+=o}}return n}function l(e){var t=e.patterns;void 0===t.g&&(t.g=t.f.replace(t.D,t.d),t.G=t.F.replace(t.D,t.d))}var p,f;e.canFormat=i,e.format=a}(a||(a={}));var v;!function(n){function a(e,t){if(!t||void 0===e)return e;var r="{0:"+t+"}";return e.replace("{0}",r)}function o(e,t){if(null==t)return t;if(h(t)){var r=n.getComponents(t),i=r.positive,a=r.negative,o=r.zero;return e>0?l(e,i):0===e?l(e,o):l(e,a)}return l(e,t)}function l(e,t){var r=i.run(R,t);return r?r[0]:t}function f(e,t,r){if(null==t)return e;if(null==e&&(e=u),h(e)){for(var i=n.getComponents(e),a=i.positive,o=i.negative,s=i.zero,c=[a,o,s],l=0;l<c.length;l++)c[l]=v(c[l],t,r);return c.join(n.NumberFormatComponentsDelimeter)}return v(e,t,r)}function v(e,t,n){if(t=Math.abs(t),t>=0){var a=n?u:s,o=r.repeat(a,Math.abs(t)),c=i.run(O,e);if(c){var l=e.substr(0,c.index),p=e.substr(c.index+1,c[1].length),f=e.substr(c.index+c[0].length);if(n)p=o;else{var v=o.length-p.length;v>0?p+=o.slice(-v):0>v&&(p=p.slice(0,v))}return p.length>0&&(p=I+p),l+p+f}if(o.length>0)return e.replace(j,"$1"+I+o)}return e}function h(e){return-1!==e.indexOf(n.NumberFormatComponentsDelimeter)}function y(e){var t={hasNegative:!1,positive:e,negative:e,zero:e},r=e.split(n.NumberFormatComponentsDelimeter),i=r.length;return i>1&&(t.hasNegative=!0,t.positive=t.zero=r[0],t.negative=r[1],i>2&&(t.zero=r[2])),t}function d(e){var t="number"==typeof e;return t}function g(e){return _.test(e)}function m(e,t,r){t=t||"G";try{return g(t)?b(e,t,r):w(e,t,r)}catch(n){return Globalize.format(e,void 0,r)}}function x(e,t,r,n){return w(e,t,n,r)}function b(e,t,n){var i,a=t.length>1?parseInt(t.substr(1,t.length-1),10):void 0,o=n.numberFormat,u=t.charAt(0);switch(u){case"e":case"E":void 0===a&&(a=6);var s=r.repeat("0",a);t="0."+s+u+"+000",i=w(e,t,n);break;case"f":case"F":i=void 0!==a?e.toFixed(a):e.toFixed(o.decimals),i=Q(i,o);break;case"g":case"G":var c=Math.abs(e);0===c||c>=1e-4&&1e15>c?i=void 0!==a?e.toPrecision(a):e.toString():(i=void 0!==a?e.toExponential(a):e.toExponential(),i=i.replace("e","E")),i=Q(i,o);break;case"r":case"R":i=e.toString(),i=Q(i,o);break;case"x":case"X":if(i=e.toString(16),"X"===u&&(i=i.toUpperCase()),void 0!==a){var l=i.length,p=0>e;p&&l--;var f=a-l,v=void 0;f>0&&(v=r.repeat("0",f)),i=p?"-"+v+i.substr(1):v+i}i=Q(i,o);break;default:i=Globalize.format(e,t,n)}return i}function w(r,o,u,s){var c,l=u.numberFormat;if(!isFinite(r))return Globalize.format(r,void 0);var p=y(o);o=r>0?p.positive:0===r?p.zero:p.negative,p.hasNegative&&(r=Math.abs(r));var f=S(o,!0);f.hasEscapes&&(o=t.preserveEscaped(o,"\\0#.,%‰"));var v=[];if(f.hasQuotes&&(o=t.preserveLiterals(o,v)),f.hasE&&!s){var h=i.run(A,o);if(h){var d=o.substr(0,h.index),g=o.substr(h.index+2),m=C(d,f),x=D(d,f);1!==x&&(r*=x);var b=r.toExponential(m),w=b.indexOf("e"),T=b.substr(0,w),P=b.substr(w+1),Q=V(T,d,l),F=V(P,g,l);"+"===F.charAt(0)&&"+"!==h[0].charAt(1)&&(F=F.substr(1));var _=h[0].charAt(0);c=Q+_+F}}if(void 0===c){var N,O=!1,m=C(o,f),x=D(o,f);if(1!==x&&(r*=x),r=parseFloat(E(r,m)),s){var R=n.getNumericFormat(r,o);s=a(s,R),N=e.formattingService.format(s,[r],u.name),O=!0}else N=E(r,m);c=V(N,o,l,s,O)}return f.hasQuotes&&(c=t.restoreLiterals(c,v)),f.hasEscapes&&(c=t.restoreEscaped(c,"\\0#.,%‰")),M=f,c}function E(t,n){var i="",a=0;n>16&&(a=n-16,n=16);var o=e.Double.log10(Math.abs(t));if(16>o){if(o>0){var u=16-o;n>u&&(a+=n-u,n=u)}i=t.toFixed(n)}else if(16===o)i=t.toFixed(0),a+=n,a>0&&(i+=".");else{i=t.toExponential(15);var s=i.indexOf("e");if(s>0){var c=i.indexOf("."),l=i.substr(0,s),p=i.substr(s+1),f=parseInt(p,10)-(l.length-c-1);i=l.replace(".","")+r.repeat("0",f),n>0&&(i=i+"."+r.repeat("0",n))}}return a>0&&(i+=r.repeat("0",a)),i}function S(e,t,r){if(void 0!==M&&e===M.format)return M;for(var n={format:e,hasEscapes:!1,hasQuotes:!1,hasE:!1,hasCommas:!1,hasDots:!1,hasPercent:!1,hasPermile:!1,precision:void 0,scale:void 0},i=0,a=e.length;a>i;i++){var o=e.charAt(i);switch(o){case"\\":n.hasEscapes=!0;break;case"'":case'"':n.hasQuotes=!0;break;case"e":case"E":n.hasE=!0;break;case",":n.hasCommas=!0;break;case".":n.hasDots=!0;break;case"%":n.hasPercent=!0;break;case"‰":n.hasPermile=!0}}var u=y(e);return t&&(n.precision=C(u.positive,n)),r&&(n.scale=D(u.positive,n)),n}function C(e,t){if(t.precision>-1)return t.precision;var r=0;if(t.hasDots){var n=e.indexOf(".");if(n>-1){for(var i=e.length,a=n;i>a;a++){var o=e.charAt(a);if(o.match(p)&&r++,o===c)break}r=Math.min(19,r)}}return t.precision=r,r}function D(e,t){if(t.scale>-1)return t.scale;var r=1;if(t.hasPercent&&e.indexOf("%")>-1&&(r=100*r),t.hasPermile&&e.indexOf("‰")>-1&&(r=1e3*r),t.hasCommas){var n=e.indexOf(".");-1===n&&(n=e.length);for(var i=n-1;i>-1;i--){var a=e.charAt(i);if(","!==a)break;r/=1e3}}return t.scale=r,r}function V(e,t,r,n,i){var a=!!n,o=t.split(".",2);if(2===o.length){var u=o[0],s=o[1],c="";n&&(c=n.replace(F,""),e=e.replace(c,""));var l=r["."],p=i?l:".",f=e.split(p,2),v=1===f.length?f[0]+c:f[0],h=2===f.length?f[1]+c:"";h=h.replace(N,"");var y=T(v,u,r,a),d=P(h,s,a);return d.fmtOnly||""===d.value?y+d.value:y+l+d.value}return T(e,t,r,a)}function T(e,t,r,n){var i=t.indexOf(","),a=i>-1&&i<Math.max(t.lastIndexOf("0"),t.lastIndexOf("#"))&&r[","],o=0,c=0,l=r.groupSizes||[3],p=l[0],f=r[","],v="",h=e.charAt(0);("+"===h||"-"===h)&&(v=r[h],e=e.substr(1));for(var y="0"===e,d="",g="",m=e.length-1,x=!0,b=t.length-1;b>-1;b--){var w=t.charAt(b);switch(w){case u:case s:x=!1,""!==g&&(d=g+d,g=""),n||((m>-1||w===u)&&a&&(o===p?(d=f+d,c++,c<l.length&&(p=l[c]),o=1):o++),m>-1?(y&&w===s||(d=e.charAt(m)+d),m--):w!==s&&(d=w+d));break;case",":break;default:g=w+g}}if(!n){if(m>-1&&""!==d)if(a)for(;m>-1;)o===p?(d=f+d,c++,c<l.length&&(p=l[c]),o=1):o++,d=e.charAt(m)+d,m--;else d=e.substr(0,m+1)+d;return v+g+d}return x?v+g+d:v+g+e+d}function P(e,t,r){var n=0,i=t.length,a=e.length;if(r){var o=t.charAt(i-1);return o.match(p)?{value:e,fmtOnly:""===e}:{value:e+o,fmtOnly:""===e}}for(var c="",l=!0,f=0;i>f;f++){var v=t.charAt(f);if(a>n)switch(v){case u:case s:c+=e[n++],l=!1;break;default:c+=v}else v!==s&&(c+=v,l=l&&v!==u)}return{value:c,fmtOnly:l}}function Q(e,t){var r=t["+"],n=t["-"],i=t["."],a=t[","];if("+"===r&&"-"===n&&"."===i&&","===a)return e;for(var o=e.length,u="",s=0;o>s;s++){var c=e.charAt(s);switch(c){case"+":u+=r;break;case"-":u+=n;break;case".":u+=i;break;case",":u+=a;break;default:u+=c}}return u}var F=/\{.+\}/,A=/e[+-]*[0#]+/i,_=/^[a-z]\d{0,2}$/i,N=/0+$/,O=/\.([0#]*)/g,R=/[0#,\.]+[0,#]*/g,j=/(0|#)([^(0|#)]*)$/,I=".";n.NumberFormatComponentsDelimeter=";",n.getNumericFormat=o,n.addDecimalsToFormat=f,n.hasFormatComponents=h,n.getComponents=y;var M;n.canFormat=d,n.isStandardFormat=g,n.format=m,n.formatWithCustomOverride=x,n.getCustomFormatMetadata=S}(v=e.NumberFormat||(e.NumberFormat={}));var h=function(){function t(e){var t=e.calendar,r=t.patterns,n=t.months.namesAbbr,i=n&&n[0],a=r.Y,o=r.M,u=r.f,s=r.T,c=r.t,l=u.indexOf(",")>-1?", ":" ",p=0===a.indexOf("yyyy'")&&a.length>6&&"'"===a[6];this.YearPattern=p?a.substr(0,7):"yyyy";var f=u.indexOf("yy"),v=u.indexOf("MMMM");this.MonthPattern=i&&v>-1?f>v?"MMM yyyy":"yyyy MMM":a,this.DayPattern=i?o.replace("MMMM","MMM"):o;var h=u.indexOf("mm"),y=u.indexOf("tt"),d=y>-1?c.replace(":mm ",""):c;switch(this.HourPattern=h>f?this.DayPattern+l+d:d+l+this.DayPattern,this.MinutePattern=c,this.SecondPattern=s,this.MillisecondPattern=s.replace("ss","ss.fff"),e.name){case"fi-FI":this.DayPattern=this.DayPattern.replace("'ta'",""),this.HourPattern=this.HourPattern.replace("'ta'","")}}return t.prototype.getFormatString=function(t){switch(t){case e.DateTimeUnit.Year:return this.YearPattern;case e.DateTimeUnit.Month:return this.MonthPattern;case e.DateTimeUnit.Week:case e.DateTimeUnit.Day:return this.DayPattern;case e.DateTimeUnit.Hour:return this.HourPattern;case e.DateTimeUnit.Minute:return this.MinutePattern;case e.DateTimeUnit.Second:return this.SecondPattern;case e.DateTimeUnit.Millisecond:return this.MillisecondPattern}},t}();e.formattingService=new f}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(t){function r(e){return JSON.stringify(e.accept(i.instance))}function n(e){for(var r="[",n=0,i=e.length;i>n;n++)n>0&&(r+=","),r+=t.serialize(e[n]);return r+"]"}t.serialize=r,t.serializeArray=n;var i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.visitColumnRef=function(e){return{col:{s:e.source.accept(this),r:e.ref}}},t.prototype.visitMeasureRef=function(e){return{measure:{s:e.source.accept(this),r:e.ref}}},t.prototype.visitAggr=function(e){return{agg:{a:e.arg.accept(this),f:e.func}}},t.prototype.visitEntity=function(e){return{e:e.entity}},t.prototype.visitAnd=function(e){return{and:{l:e.left.accept(this),r:e.right.accept(this)}}},t.prototype.visitCompare=function(e){return{comp:{k:e.comparison,l:e.left.accept(this),r:e.right.accept(this)}}},t.prototype.visitConstant=function(e){return{"const":{t:e.type.primitiveType,v:e.value}}},t.prototype.visitDefault=function(e){},t.instance=new t,t}(e.DefaultSQExprVisitor)}(t=e.SQExprShortSerializer||(e.SQExprShortSerializer={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var r,n=e.Prototype.inheritSingle;!function(t){function r(e,t){var r=e,n=e.categorical;if(n){var a=i(n,t);a&&(r=o(e,a))}return r}function i(e,t){var r,n=t&&1===t.length&&t[0].categorical?t[0]:void 0;if(n){var i=a(n.categorical);if(i&&1===i.length){var o=i[0],u=!_.isEmpty(n.conditions)&&_.every(n.conditions,function(e){return e[o]&&1===e[o].max});if(u){var s=_.filter(e.categories,function(e){return e.source.roles&&!!e.source.roles[o]}),c=_.every(s,function(e){return e.values.length===s[0].values.length});c&&s.length>=2&&(r={roleName:o,categories:s})}}}return r}function a(e){var t=[];if(e.categories){var r=e.categories.select;r||(r=[e.categories]);for(var n=0;n<r.length;n++){var i=r[n],a=i["for"];if(a)t.push(a["in"]);else{var o=i.bind;o&&t.push(o.to)}}}return t}function o(e,t){var r=u(t.categories),i=s(t.categories,t.roleName),a=n(e);c(a,i);var o=l(t.categories,i,r),p=e.categorical,f=_.difference(p.categories,t.categories);f.push(o);var v=n(p);return v.categories=f,a.categorical=v,a}function u(e){for(var t=[],r=0;r<e.length;r++)for(var n=e[r],i=0,a=n.values.length;a>i;i++){var o=n.values&&n.values[i];t[i]=void 0===t[i]?o+"":t[i]+" "+o}return t}function s(t,r){debug.assertNonEmpty(t,"categoryColumns");for(var n,i=t[0].source.isMeasure,a=0;a<t.length;a++){var o=t[a],u=o.source;n=null==n?u.displayName:n+" "+u.displayName,i!==u.isMeasure&&(i=void 0)}var s={};s[r]=!0;var c={displayName:n,roles:s,type:e.ValueType.fromPrimitiveTypeAndCategory(e.PrimitiveType.Text)};return void 0!==i&&(c.isMeasure=i),c.queryName="Concatenated Column Metadata",c}function c(e,t){var r=n(e.metadata.columns);r.push(t);var i=n(e.metadata);i.columns=r,e.metadata=i}function l(e,t,r){var n={source:t,values:r},i=e[0];return i.identity&&(n.identity=i.identity),i.identityFields&&(n.identityFields=i.identityFields),n}t.detectAndApply=r}(r=t.DataViewConcatenateCategoricalColumns||(t.DataViewConcatenateCategoricalColumns={}))}(t=e.data||(e.data={}))}(powerbi||(powerbi={}));
//# sourceMappingURL=VisualsData.min.js.map
